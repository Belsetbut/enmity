const modules$1={Constants:{props:["ActionTypes"]},Clipboard:{props:["setString","getString"]},Assets:{props:["registerAsset"]},Messages:{props:["receiveMessage","sendMessage"]},Clyde:{props:["createBotMessage"]},Avatars:{props:["BOT_AVATARS"]},Native:{props:["NativeModules"],export:"NativeModules"},React:{props:["createElement"]},Dispatcher:{props:["dirtyDispatch"]},Storage:{props:["getItem"]},Toasts:{props:["open","close"],ensure:e=>!e.openLazy&&!e.startDrag&&!e.init&&!e.openReplay},Dialog:{props:["show","openLazy","open","close"]},Token:{props:["getToken"]},REST:{props:["getAPIBaseURL"]},Settings:{props:["watchKeys"]},Users:{props:["getCurrentUser"]},Subscriptions:{props:["getPremiumTypeSubscription"]},Navigation:{props:["pushLazy"]},NavigationNative:{props:["NavigationContainer"]},NavigationStack:{props:["createStackNavigator"]},Theme:{props:["theme"]},Linking:{props:["openURL"]},StyleSheet:{props:["createThemedStyleSheet"]},ColorMap:{props:["ThemeColorMap"]},Components:{multiple:!0,props:{Forms:["Form","FormSection"],General:["Button","Text","View"]}},Locale:{props:["Messages"]},Profiles:{props:["showUserProfile"]},Lodash:{props:["debounce","throttle"]},Logger:{name:"Logger"},Flux:{props:[["Store","connectStores"],["useStateFromStoresObject"]]},SVG:{props:["Svg"]},Scenes:{name:"getScreens",default:!1}},common={},blacklist$1=[e=>e>=951&&e<=1006,125,203,433,434,445,446,457],filters={byProps:(...e)=>t=>e.every(n=>t[n]!==void 0),byName:(e,t=!0)=>n=>n?t?typeof n=="function"&&n.name===e:typeof n.default=="function"&&n.default.name===e:!1,byTypeName:(e,t=!0)=>n=>n?t?typeof n=="function"&&n.name===e:typeof n.default=="function"&&n.default.type?.name===e:!1,byDisplayName:(e,t=!0)=>n=>n?t?typeof n=="function"&&n.name===e:typeof n.default=="function"&&n.default.name===e:!1},getters=[];Object.entries(modules$1).map(([e,t])=>{if(t.multiple)Object.entries(t.props).map(([n,s])=>{getters.push({id:n,filter:o=>filters.byProps(...s)(o),submodule:e})});else if(t.props)if(t.props.every(n=>Array.isArray(n))){const n=[];getters.push({id:e,filter:s=>{const o=t.props.some(r=>r.every(a=>s[a]));return o&&t.ensure&&!t.ensure(s)?!1:(o&&n.push(s),o)},map:Object.assign({},...n)})}else getters.push({id:e,filter:n=>{const s=filters.byProps(...t.props)(n);return s&&t.ensure&&t.ensure(n)===!1?!1:s},map:t.export});else t.displayName?getters.push({id:e,filter:filters.byDisplayName(t.displayName,t.default),map:t.export}):t.name?getters.push({id:e,filter:filters.byName(t.name,t.default),map:t.export}):t.filter&&getters.push({id:e,filter:t.filter,map:t.export})});const results=bulk(...getters.map(({filter:e})=>e));getters.map(({id:e,map:t,submodule:n},s)=>{let o=a=>a;if(typeof t=="string")o=a=>a[t];else if(Array.isArray(t)){let a={};o=i=>{for(const l of t)a[l]=i[l];return a}}const r=o(results[s]);n?(common[n]??={},common[n][e]=r):common[e]=r});function getModule(e,{all:t=!1,traverse:n=!0,defaultExport:s=!0}={}){if(typeof e!="function")return null;const o=[],r=function(a,i){try{return e(a,i)}catch{return!1}};for(const a in modules){if(blacklist$1.some(l=>typeof l=="function"?l(a):l===Number(a)))continue;modules[a].isInitialized||__r(Number(a));const i=modules[a].publicModule.exports;if(!(!i||i===window)){if(typeof i=="object"){if(r(i,a)){if(!t)return i;o.push(i)}if(i.__esModule&&i.default&&r(i.default,a)){const l=s?i.default:i;if(!t)return l;o.push(l)}if(n&&i.__esModule){for(const l in i)if(i[l]!==void 0&&r(i[l],a)){if(!t)return i[l];o.push(i[l])}}}else if(typeof i=="function"){if(!r(i,a))continue;if(!t)return i;o.push(i)}}}return t?o:o[0]}function getModules(e){return getModule(e,{all:!0})}function bulk(...e){const t=new Array(e.length),n=e.map(s=>o=>{try{return s(o)}catch{return!1}});return getModule(s=>{for(let o=0;o<n.length;o++){const r=n[o];typeof r!="function"||!r(s)||t[o]!=null||(t[o]=s)}return t.filter(String).length===e.length}),t}function getByProps(...e){const[t,{bulk:n=!1,...s}]=parseOptions(e);if(n){const o=t.map(r=>Array.isArray(r)?o.byProps(...r):o.byProps(r)).concat({...s});return n(...o)}return getModule(filters.byProps(...t),s)}function getByDisplayName(...e){const[t,{bulk:n=!1,default:s=!0,...o}]=parseOptions(e);if(n){const r=t.map(filters.byDisplayName).concat({defaultExport:s,...o});return n(...r)}return getModule(filters.byDisplayName(t[0]),{defaultExport:s,...o})}function getByTypeName(...e){const[t,{bulk:n=!1,default:s=!0,...o}]=parseOptions(e);if(n){const r=t.map(filters.byTypeName).concat({defaultExport:s,...o});return n(...r)}return getModule(filters.byTypeName(t[0]),{defaultExport:s,...o})}function getByName$1(...e){const[t,{bulk:n=!1,default:s=!0,...o}]=parseOptions(e);if(n){const r=t.map(filters.byName).concat({defaultExport:s,...o});return n(...r)}return getModule(filters.byName(t[0]),{defaultExport:s,...o})}function getByKeyword(...e){const[[t],{caseSensitive:n=!1,all:s=!1,...o}]=parseOptions(e);return getModule(r=>{const a=[...Object.keys(r),...Object.keys(r.__proto__)];for(let i=0;i<a.length;i++){const l=a[i];if(n){if(~l.indexOf(t))return!0}else{const c=t.toLowerCase();if(~l.toLowerCase().indexOf(c))return!0}}return!1},{all:s,...o})}function parseOptions(e,t=n=>typeof n=="object"&&!Array.isArray(n)){return[e,t(e[e.length-1])?e.pop():{}]}var Modules=Object.freeze({__proto__:null,common,filters,getModule,getModules,bulk,getByProps,getByDisplayName,getByTypeName,getByName:getByName$1,getByKeyword});const{Clipboard,Assets:Assets$3,Messages,Clyde:Clyde$1,Avatars,Native,Dispatcher,Storage,Toasts,Dialog,Token,REST,Settings:Settings$3,Users,Theme,Linking,StyleSheet:StyleSheet$1,ColorMap,Components:Components$1,Locale,Constants,Profiles,Logger:Logger$1,Lodash,Flux,SVG,Scenes,Subscriptions,Navigation,NavigationNative,NavigationStack}=common;common.React;const patches$1=[];function getPatchesByCaller(e){if(!e)return[];const t=[];for(const n of patches$1){const s=[...n.patches.before,...n.patches.instead,...n.patches.after];for(const o of s)o.caller===e&&t.push(o)}return t}function unpatchAll$1(e){const t=getPatchesByCaller(e);if(!!t.length)for(const n of t)n.unpatch()}function override(e){return function(){if(!e?.patches?.before.length&&!e?.patches?.after.length&&!e?.patches?.instead.length&&!patches$1.find(a=>a.mdl===e.mdl&&a.func===e.func))return e.unpatch(),new.target?new e.original(...arguments):e.original.apply(this,arguments);let t,n=arguments;const s=e.patches.before;for(let a=0;a<s.length;a++){const i=s[a];if(!!i)try{const l=i.callback(this,n,e.original.bind(this));Array.isArray(l)&&(n=l),i.once&&i.unpatch()}catch(l){console.error(`Could not fire before patch for ${e.func} of ${i.caller}`),console.error(l)}}const o=e.patches.instead;if(!o.length)new.target?t=new e.original(...n):t=e.original.apply(this,n);else for(let a=0;a<o.length;a++){const i=o[a];if(!!i)try{const l=i.callback(this,n,e.original.bind(this));typeof l<"u"&&(t=l),i.once&&i.unpatch()}catch(l){console.error(`Could not fire instead patch for ${e.func} of ${i.caller}`),console.error(l)}}const r=e.patches.after;for(let a=0;a<r.length;a++){const i=r[a];if(!!i)try{i.caller.includes("downloader")&&console.log(i);const l=i.callback(this,n,t,c=>t=c);typeof l<"u"&&(t=l),i.once&&i.unpatch()}catch(l){console.error(`Could not fire after patch for ${e.func} of ${i.caller}`),console.error(l)}}return t}}function push$1([,e,t,,n,s]){const o={mdl:e,func:t,id:patches$1?.[n]?.length??0,original:e[t],once:s,unpatch:()=>{o.mdl[o.func]=o.original,o.patches={before:[],after:[],instead:[]}},patches:{before:[],after:[],instead:[]}};e[t]=override(o);const r=Object.getOwnPropertyDescriptors(o.original);return delete r.length,Object.defineProperties(e[t],{...r,toString:{value:()=>o.original.toString(),configurable:!0,enumerable:!1},__original:{value:o.original,configurable:!0,enumerable:!1}}),patches$1.push(o),o}function get$2([,e,t]){const n=patches$1.find(s=>s.mdl===e&&s.func===t);return n||push$1(...arguments)}function patch$1(e,t,n,s,o="after",r=!1){if(!e||typeof e!="string")throw new TypeError('first argument "caller" must be of type string');if(!t||!["function","object"].includes(typeof t))throw new TypeError('second argument "mdl" must be of type function or object');if(!n||typeof n!="string")throw new TypeError('third argument "func" must be of type string');if(!s||typeof s!="function")throw new TypeError('fourth argument "callback" must be of type function');if(!o||typeof o!="string"||!["after","before","instead"].includes(o))throw new TypeError('fifth argument "type" must be of type string and any of the three: after, before, instead');if(typeof t[n]>"u")throw new ReferenceError(`function ${n} does not exist on the second argument (object or function)`);const a=get$2(arguments),i={caller:e,once:r,type:o,id:a.patches?.[o]?.length??0,callback:s,unpatch:()=>{const l=a.patches?.[o].findIndex(u=>u.id===i.id);if(~l&&a.patches?.[o].splice(l,1),a.patches?.before.length||a.patches?.after.length||a.patches?.instead.length)return;const c=patches$1.findIndex(u=>u.mdl==t&&u.func==n);!c||(patches$1[c]?.unpatch(),patches$1.splice(c,1))}};return a.patches[o]??=[],a.patches[o].push(i),i.unpatch}function before$1(e,t,n,s,o=!1){return patch$1(e,t,n,s,"before",o)}function instead$1(e,t,n,s,o=!1){return patch$1(e,t,n,s,"instead",o)}function after$1(e,t,n,s,o=!1){return patch$1(e,t,n,s,"after",o)}function create$1(e){return{getPatchesByCaller,before:(t,n,s)=>before$1(e,t,n,s),instead:(t,n,s)=>instead$1(e,t,n,s),after:(t,n,s)=>after$1(e,t,n,s),unpatchAll:()=>unpatchAll$1(e)}}var patcher={create:create$1,before:before$1,instead:instead$1,after:after$1,unpatchAll:unpatchAll$1,patches:patches$1},Patcher$4=Object.freeze({__proto__:null,create:create$1,before:before$1,instead:instead$1,after:after$1,unpatchAll:unpatchAll$1,patches:patches$1,default:patcher});const assets={};patcher.after("enmity-assets",Assets$3,"registerAsset",(e,[t],n)=>{assets[t.name]={...t,id:n}});for(let e=1;;e++){const t=Assets$3.getAssetByID(e);if(!t)break;assets[t.name]||(assets[t.name]={...t,id:e})}function find(e){return Object.values(assets).find(e)}function getByName(e){return assets[e]}function getByID(e){return Assets$3.getAssetByID(e)}function getIDByName(e){return assets[e]?.id}var Assets$1={assets,getByName,getByID,getIDByName},Assets$2=Object.freeze({__proto__:null,assets,find,getByName,getByID,getIDByName,default:Assets$1});const settings=Settings$3.get("enmity")??{};function getSetting(e,t,n){return settings[e]?.[t]??n}function get$1(e){return settings[e]??{}}function getAll(){return settings}const Events$2={ENMITY_GET_SETTING:({file:e,setting:t,defaults:n})=>settings[e][t]??n,ENMITY_SET_SETTING:({file:e,setting:t,value:n})=>{settings[e]||(settings[e]={}),n==null?delete settings[e][t]:settings[e][t]=n},ENMITY_TOGGLE_SETTING:({file:e,setting:t,defaults:n})=>{settings[e]||(settings[e]={}),settings[e][t]===void 0?settings[e][t]=!Boolean(n):settings[e][t]=!Boolean(settings[e][t])}},store=new Flux.Store(Dispatcher,Events$2);store.addChangeListener(Lodash.debounce(()=>Settings$3.set({enmity:settings}),200));var Manager={store,getAll,getSetting,get:get$1},React=common.React;const listeners={};Dispatcher.subscribe("ENMITY_SET_SETTING",ENMITY_SET_SETTING),Dispatcher.subscribe("ENMITY_TOGGLE_SETTING",ENMITY_TOGGLE_SETTING);function ENMITY_SET_SETTING(e){return handleSettingsUpdate({...e,type:"set"})}function ENMITY_TOGGLE_SETTING(e){return handleSettingsUpdate({...e,type:"toggle"})}function handleSettingsUpdate({file:e,type:t,...n}){const s=listeners[e];if(!!s)for(const o of s.values())o({...n})}function set(e,t,n){if(!e||typeof e!="string")throw new TypeError("the first argument file must be of type string");if(!t||typeof t!="string")throw new TypeError("the second argument setting must be of type string");return Dispatcher.dirtyDispatch({type:"ENMITY_SET_SETTING",file:e,setting:t,value:n})}function get(e,t,n){if(!e||typeof e!="string")throw new TypeError("the first argument file must be of type string");if(!t||typeof t!="string")throw new TypeError("the second argument setting must be of type string");return Manager.getSetting(e,t,n)}function getBoolean(e,t,n){if(!e||typeof e!="string")throw new TypeError("the first argument file must be of type string");if(!t||typeof t!="string")throw new TypeError("the second argument setting must be of type string");return Boolean(Manager.getSetting(e,t,n))}function toggle(e,t,n){if(!e||typeof e!="string")throw new TypeError("the first argument file must be of type string");if(!t||typeof t!="string")throw new TypeError("the second argument setting must be of type string");if(n===void 0||typeof n!="boolean")throw new TypeError("the third argument defaults must be of type boolean");return Dispatcher.dirtyDispatch({type:"ENMITY_TOGGLE_SETTING",file:e,setting:t,defaults:n})}function connectComponent(e,t){if(!e||!["function","object"].includes(typeof e))throw new TypeError("the first argument component must be of type function or object");if(!t||typeof t!="string")throw new TypeError("the second argument file must be of type string");const n=s=>{const o=React.useState({})[1];return React.useEffect(()=>{function r(){o({})}return subscribe(t,r),()=>unsubscribe(t,r)},[]),React.createElement(e,{...s,settings:makeStore(t)})};return e.displayName&&(n.displayName=e.displayName),e.name&&(n.name=`Connected${e.name}`),n}function makeStore(e){if(!e||typeof e!="string")throw new TypeError("the first argument file must be of type string");return{settings:Manager.get(e),set:(t,n)=>set(e,t,n),get:(t,n)=>get(e,t,n),toggle:(t,n)=>toggle(e,t,n),getBoolean:(t,n)=>getBoolean(e,t,n)}}function subscribe(e,t){if(!e||typeof e!="string")throw new TypeError("the first argument file must be of type string");if(!t||typeof t!="function")throw new TypeError("the second argument callback must be of type function");listeners[e]??=new Set,listeners[e].add(t)}function unsubscribe(e,t){if(!e||typeof e!="string")throw new TypeError("the first argument file must be of type string");if(!t||typeof t!="function")throw new TypeError("the second argument callback must be of type function");listeners[e]?.delete(t),listeners[e]?.size===0&&delete listeners[e]}function connectStores(e){return Flux.connectStores([Manager.store],()=>({settings:makeStore(e)}))}var Settings$1={connectComponent,connectStores,unsubscribe,subscribe,makeStore,listeners,toggle,get,set},Settings$2=Object.freeze({__proto__:null,listeners,set,get,getBoolean,toggle,connectComponent,makeStore,subscribe,unsubscribe,connectStores,default:Settings$1,settings,store});const Logger=getByName$1("Logger"),EnmityLogger=new Logger("Enmity");let socket;function connectWebsocket(host){console.log("Connecting to debug WebSocket"),socket!==void 0&&socket.readyState!==WebSocket.CLOSED&&(socket.close(),socket=null);const address=Boolean(Settings$1.get("enmity","autoConnectWS",!1))&&Settings$1.get("enmity","debugWSAddress");!address&&!host||(socket=new WebSocket(`ws://${host??address}`),socket.addEventListener("open",()=>{console.log("Connected with debug websocket"),Toasts.open({content:"Connected to the websocket server."})}),socket.addEventListener("error",e=>{console.log(`Error with debug websocket: ${e.message}`),Toasts.open({content:"An error occured with the websocket connection."})}),socket.addEventListener("close",e=>{console.log(`Error with debug websocket: ${e.message}`),Toasts.open({content:"The websocket connection has been closed."})}),socket.addEventListener("message",message=>{try{console.log(eval(message.data))}catch(e){console.error(e)}}))}function initialize$4(){const e=nativeLoggingHook;globalThis.nativeLoggingHook=function(t,n){return socket?.readyState===WebSocket.OPEN&&socket.send(JSON.stringify({level:n,message:t})),EnmityLogger.log(t),e.apply(this,arguments)},Settings$1.get("enmity","autoConnectWS",!1)&&connectWebsocket()}function sendMessage(e){socket?.readyState===WebSocket.OPEN&&socket.send(e)}var WebSocket$1={initialize:initialize$4,sendMessage,connectWebsocket,socket};const AddonChannels={Plugins:["961782195767365732"],Themes:["961782176062509117","968223084643487744"]},Patcher$3=create$1("enmity-commands"),[Commands$1,Discovery,Assets]=bulk(filters.byProps("getBuiltInCommands"),filters.byProps("useApplicationCommandsDiscoveryState"),filters.byProps("getApplicationIconURL"));let commands=[];const section={id:"enmity",type:1,name:"Enmity",icon:"https://files.enmity.app/icon.png"};Patcher$3.after(Commands$1,"getBuiltInCommands",(e,t,n)=>[...n,...commands.values()]),Patcher$3.after(Assets,"getApplicationIconURL",(e,[t],n)=>{if(t.id==="enmity")return section.icon}),Patcher$3.after(Discovery,"useApplicationCommandsDiscoveryState",(e,[,,,t],n)=>{if(t!==!1)return n;if(!n.discoverySections.find(o=>o.key===section.id)&&commands.length){const o=[...commands.values()];n.discoveryCommands.push(...o),n.commands.push(...o.filter(r=>!n.commands.some(a=>a.name===r.name))),n.discoverySections.push({data:o,key:section.id,section}),n.sectionsOffset.push(commands.length)}!n.applicationCommandSections.find(o=>o.id===section.id)&&commands.length&&n.applicationCommandSections.push(section);const s=n.discoverySections.findIndex(o=>o.key==="-2");if(n.discoverySections[s]?.data){const o=n.discoverySections[s];o.data=o.data.filter(r=>!r.__enmity),o.data.length===0&&n.discoverySections.splice(s,1)}});function registerCommands(e,t){t.map(n=>{n.__enmity=!0,n.caller=e}),commands.push(...t)}function unregisterCommands(e){commands=commands.filter(t=>t.caller!==e)}var Commands$2=Object.freeze({__proto__:null,section,registerCommands,unregisterCommands});function uuid(e=10){let t="";do{const n=Math.random()*16|0;t+=(t.length==12?4:t.length==16?n&3|8:n).toString(16)}while(t.length<e);return t}const replies={};Linking.addEventListener("url",e=>{let t=e.url;t=decodeURIComponent(t.replace("com.hammerandchisel.discord://",""));try{const n=JSON.parse(t);if(n.data===void 0)return;replies[n.id]&&(replies[n.id](n.data),delete replies[n.id])}catch{return}});function sendCommand(e,t=[],n){const s=uuid();Linking.openURL(`com.hammerandchisel.discord://enmity?id=${s}&command=${e}&params=${t.join(",")}`).then(()=>{n&&(replies[s]=n)})}const EventEmitter$1=getByProps("EventEmitter").EventEmitter;let plugins$1=[],enabled=window.plugins.enabled,disabled=window.plugins.disabled;const Events$1=new EventEmitter$1;function registerPlugin(e){!e||typeof e!="object"||(e.onEnable=()=>{try{e.onStart(),e.commands&&registerCommands(e.name,e.commands),console.log(`${e.name} has been enabled`)}catch(t){console.log(`${e.name} failed to load`,t.message)}},e.onDisable=()=>{try{if(e.patches)for(const t of e.patches)t.unpatchAll();e.commands&&unregisterCommands(e.name),e.onStop(),console.log(`${e.name} has been disabled`)}catch(t){console.log(`${e.name} failed to disable`,t.message)}},enabled.includes(e.name)&&e.onEnable(),disabled.includes(e.name)&&e.onDisable(),getPlugin(e.name)||plugins$1.push(e))}const on$1=Events$1.on.bind(Events$1),once$1=Events$1.once.bind(Events$1),off$1=Events$1.off.bind(Events$1);function getPlugin(e){return plugins$1.find(t=>t.name===e)}function getPlugins(){return plugins$1}function getEnabledPlugins(){return enabled}function getDisabledPlugins(){return disabled}function disablePlugin(e,t=!1,n){if(enabled.includes(e)){const s=enabled.indexOf(e);~s&&enabled.splice(s,1)}if(t&&disabled.includes(e)){const s=disabled.indexOf(e);~s&&disabled.splice(s,1)}return t||disabled.push(e),getPlugin(e).onDisable(),new Promise(s=>{sendCommand("disable-plugin",[e],(...o)=>{n&&n(...o),s(...o)})})}function enablePlugin(e,t){if(disabled.includes(e)){const n=disabled.indexOf(e);~n&&disabled.splice(n,1)}return enabled.push(e),getPlugin(e).onEnable(),new Promise(n=>{sendCommand("enable-plugin",[e],(...s)=>{t&&t(...s),n(...s)})})}async function evalPlugin(url,enable=!1,update){try{const response=await REST.get(url),code=response.text,name=url.split("/").pop().split(".")[0],id=Number(Object.keys(window.modules).pop())+1,wrapper=`__d(function(...args) {
        try {
          ${code}
        } catch(err) {
          console.log(err);
        }
      }, ${id}, []);
      __r(${id})`;try{eval(wrapper),enable&&!enabled.includes(name)&&await enablePlugin(name)}catch(e){console.log("Failed to eval plugin instance",e.message)}return update&&update(),name}catch(e){console.log("Failed to eval plugin instance",e.message)}}function installPlugin(e,t,n){const s=e.split("/").pop().split(".")[0];return new Promise(o=>{sendCommand("install-plugin",[e],r=>{function a(){evalPlugin(e,!0).then(i=>{const l={name:i,data:r,url:e};Events$1.emit("installed"),t&&t(l),n(),o(l)})}return r==="overridden_plugin"?disablePlugin(s,!0).then(a):a()})})}function uninstallPlugin(e,t){return new Promise(n=>{disablePlugin(e),sendCommand("uninstall-plugin",[e],s=>{enabled=enabled.filter(r=>r!==e),disabled=disabled.filter(r=>r!==e);const o=plugins$1.findIndex(r=>r.name===e);o>-1&&plugins$1.splice(o,1),Events$1.emit("uninstalled"),t&&t(s),n(s)})})}var Plugins=Object.freeze({__proto__:null,registerPlugin,on:on$1,once:once$1,off:off$1,getPlugin,getPlugins,getEnabledPlugins,getDisabledPlugins,disablePlugin,enablePlugin,evalPlugin,installPlugin,uninstallPlugin});function reloadDiscord(){return Native.BundleUpdaterManager.reload()}function getVersion(){return Native.InfoDictionaryManager.Version}function getBuild(){return Native.InfoDictionaryManager.Build}function getDevice(){return Native.DCDDeviceManager.device}function getSystemVersion(){return Native.DCDDeviceManager.systemVersion}let theme=window.themes?.theme??"",themes$2=window.themes?.list??[];const EventEmitter=getByProps("EventEmitter").EventEmitter,Events=new EventEmitter,on=Events.on.bind(Events),once=Events.once.bind(Events),off=Events.off.bind(Events);function getTheme(){return theme}function getThemeByName(e){return themes$2.find(t=>t.name===e)}function listThemes(){return themes$2}async function installTheme(e,t){return new Promise(n=>{sendCommand("install-theme",[e],s=>{REST.get(e).then(o=>{const r=JSON.parse(o.text);if(!r)throw new Error("Invalid theme structure");const a=themes$2.findIndex(l=>l.name===r.name);a>-1&&themes$2.splice(a,1),themes$2.push(r);const i={theme:r,url:e,data:s,restart:getTheme()===r.name};t&&t(i),Events.emit("installed"),n(i)})})})}function applyTheme(e,t){return new Promise(n=>{sendCommand("apply-theme",[e,Theme.theme],s=>{theme=e,t&&t(s),n(s)})})}function removeTheme(e){return new Promise(t=>{sendCommand("remove-theme",[],n=>{theme="",e&&e(n),t(n)})})}async function uninstallTheme(e,t){return getTheme()===e&&removeTheme(),new Promise(n=>{sendCommand("uninstall-theme",[e],s=>{const o=themes$2.findIndex(r=>r.name===e);o>-1&&themes$2.splice(o,1),Events.emit("uninstalled"),t&&t(s),n(s)})})}var Themes=Object.freeze({__proto__:null,on,once,off,getTheme,getThemeByName,listThemes,installTheme,applyTheme,removeTheme,uninstallTheme});function findInTree(e={},t=r=>r,{ignore:n=[],walkable:s=[],maxProperties:o=100}={}){let r=[e];const a=function(...i){try{return Reflect.apply(t,this,i)}catch{return!1}};for(;r.length&&o;){const i=r.shift();if(a(i))return i;if(Array.isArray(i))r.push(...i);else if(typeof i=="object"&&i!==null)if(s.length)for(const l in i){const c=i[l];~s.indexOf(l)&&!~n.indexOf(l)&&r.push(c)}else for(const l in i){const c=i[l];i&&~n.indexOf(l)||r.push(c)}o--}}function findInReactTree(e,t=s=>s,n={}){return findInTree(e,t,{walkable:["props","children"],...n})}const Patcher$2=patcher.create("enmity-sheet-patcher"),patches={},Opener=getByProps("openLazy");Patcher$2.before(Opener,"openLazy",(e,[t,n,s,o])=>{!patches[n]||(console.log(o),t.then(r=>{const a=Patcher$2.after(r,"default",(i,l,c)=>{for(let u=0;u<patches[n].length;u++){const d=patches[n][u];if(d.applied)continue;const h=d.callback;patcher[d.type](d.caller,c.type,"render",(g,p,f)=>{const m=findInReactTree(p[0],y=>y.find?.(b=>Array.isArray(b)));if(!!m)return[m[0]?.props,m[1],...p],h.apply(g,[g,p,f])}),d.applied=!0}return a(),c});return r}))});function before(e,t,n){validateArguments(e,t,n),push("before",e,t,n)}function after(e,t,n){validateArguments(e,t,n),push("after",e,t,n)}function instead(e,t,n){validateArguments(e,t,n),push("instead",e,t,n)}function unpatchAll(e){for(const t in patches){const n=patches[t];patches[n]=n.filter(s=>s.caller!==e)}return Patcher$2.unpatchAll(e)}function create(e){return{before:(t,n)=>before(e,t,n),after:(t,n)=>after(e,t,n),instead:(t,n)=>instead(e,t,n),unpatchAll:()=>unpatchAll(e)}}function push(e,t,n,s){setTimeout(()=>console.log(s.name),2e3),patches[n]??=[],patches[n].push({type:e,caller:t,sheet:n,callback:s,applied:!1})}function validateArguments(e,t,n){if(!e||typeof e!="string")throw new TypeError("first argument caller does not exist or is not of type string");if(!t||typeof t!="string")throw new TypeError("second argument menu does not exist or is not of type string");if(!n||typeof n!="function")throw new TypeError("third argument callback does not exist or is not of type function")}var SheetPatcher={patches,unpatchAll,instead,create,before,after};const{Alert,Button,FlatList,Image,ImageBackground,KeyboardAvoidingView,Modal,Pressable,RefreshControl,ScrollView,SectionList,StatusBar,StyleSheet,Switch,Text,TextInput,TouchableHighlight,TouchableOpacity,TouchableWithoutFeedback,Touchable,View,VirtualizedList}=Components$1.General,{Form,FormArrow,FormCTA,FormCTAButton,FormCardSection,FormCheckbox,FormDivider,FormHint,FormIcon,FormInput,FormLabel,FormRadio,FormRow,FormSection,FormSelect,FormSubLabel,FormSwitch,FormTernaryCheckBox,FormText,FormTextColors,FormTextSizes}=Components$1.Forms;var Components=Object.freeze({__proto__:null,Alert,Button,FlatList,Image,ImageBackground,KeyboardAvoidingView,Modal,Pressable,RefreshControl,ScrollView,SectionList,StatusBar,StyleSheet,Switch,Text,TextInput,TouchableHighlight,TouchableOpacity,TouchableWithoutFeedback,Touchable,View,VirtualizedList,Form,FormArrow,FormCTA,FormCTAButton,FormCardSection,FormCheckbox,FormDivider,FormHint,FormIcon,FormInput,FormLabel,FormRadio,FormRow,FormSection,FormSelect,FormSubLabel,FormSwitch,FormTernaryCheckBox,FormText,FormTextColors,FormTextSizes});const Icon=getByTypeName("Icon"),{ThemeColorMap:ThemeColorMap$7}=ColorMap;function patchDownloader(){SheetPatcher.after("enmity-downloader","MessageLongPressActionSheet",(e,[{channel:t,message:n},s])=>{const o=StyleSheet$1.createThemedStyleSheet({icon:{color:ThemeColorMap$7.INTERACTIVE_NORMAL}});if(AddonChannels.Plugins.includes(t.id)){const r=n.content.match(/http(|s).+.js/gmi)?.[0];if(!r)return;s.unshift(React.createElement(FormRow,{label:"Install Plugin",leading:React.createElement(Icon,{...o.icon,size:"medium",disableColor:!1,source:getIDByName("ic_download_24px")}),onPress:()=>{installPlugin(r,({data:a})=>{const i={icon:null,text:null};switch(a){case"fucky_wucky":i.text="Failed plugin installation.",i.icon=getIDByName("ic_close_16px");break;case"installed_plugin":i.text="Plugin has been installed.",i.icon=getIDByName("Check");break;case"overridden_plugin":i.text="Plugin has been overriden.",i.icon=getIDByName("Check");break}Toasts.open({content:i.text,source:i.icon})})}}))}if(AddonChannels.Themes.includes(n.channel_id)){const r=n.content.match(/http(|s).+.json/gmi)?.[0];if(!r)return;s.unshift(React.createElement(FormRow,{label:"Install Theme",leading:React.createElement(Icon,{...o.icon,size:"medium",disableColor:!1,source:getIDByName("ic_download_24px")}),onPress:()=>{installTheme(r,({data:a,restart:i})=>{const l={icon:null,text:null,restart:!1};switch(a){case"fucky_wucky":l.text="Failed theme installation.",l.icon=getIDByName("ic_close_16px");break;case"installed_theme":l.text="Theme has been installed.",l.icon=getIDByName("Check"),l.restart=i;break;case"overridden_theme":l.text="Theme has been overriden.",l.icon=getIDByName("Check"),l.restart=i;break}if(Toasts.open({content:l.text,source:l.icon}),l.restart)return Dialog.show({title:"Theme Replaced",body:"Replacing the theme you previously had applied requires a restart, would you like to restart Discord to reload the theme values?",confirmText:"Yes",cancelText:"No",onConfirm:reloadDiscord})})}}))}})}const Settings=NavigationStack.createStackNavigator(),{ThemeColorMap:ThemeColorMap$6}=ColorMap;function PluginSettings({name:e="hi",children:t=React.createElement(Text,null,"hi")}={}){const n=StyleSheet$1.createThemedStyleSheet({container:{backgroundColor:ThemeColorMap$6.BACKGROUND_MOBILE_SECONDARY,flex:1},cardStyle:{backgroundColor:"transparent"},header:{backgroundColor:ThemeColorMap$6.BACKGROUND_MOBILE_SECONDARY,shadowColor:"transparent",elevation:0},headerTitleContainer:{color:ThemeColorMap$6.HEADER_PRIMARY},close:{color:ThemeColorMap$6.HEADER_PRIMARY}});return React.createElement(NavigationNative.NavigationContainer,null,React.createElement(Settings.Navigator,{initialRouteName:e,style:n.container},React.createElement(Settings.Screen,{name:e,component:t,options:{cardOverlayEnabled:!1,cardShadowEnabled:!1,cardStyle:n.cardStyle,headerStyle:n.header,headerTitleContainerStyle:n.headerTitleContainer,headerTitleAlign:"center",animationEnabled:!0,animationTypeForReplace:"pop",safeAreaInsets:{top:0},headerTitleStyle:{color:"white"},headerLeft:()=>React.createElement(Button,{color:n.close.color,title:"Close",onPress:()=>Navigation.pop()}),...NavigationStack.TransitionPresets.ModalSlideFromBottomIOS}})))}const{ThemeColorMap:ThemeColorMap$5}=ColorMap;function Authors({authors:e}){if(!e||!Array.isArray(e)||!e.length)return null;const t=StyleSheet$1.createThemedStyleSheet({linkless:{color:ThemeColorMap$5.HEADER_SECONDARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,display:"flex",alignItems:"center",alignSelf:"center",justifyContent:"center"},link:{color:ThemeColorMap$5.HEADER_PRIMARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,display:"flex",alignItems:"center",alignSelf:"center",justifyContent:"center"},container:{marginLeft:2.5}});return React.createElement(View,{style:t.container},e.map((n,s)=>{const o=s!==e.length-1;return typeof n=="string"?React.createElement(Text,{style:t.linkless},n,o&&","):typeof n=="object"&&n.name&&!n.id?React.createElement(Text,{style:t.linkless},n.name,o&&","):typeof n=="object"&&n.name&&n.id?React.createElement(TouchableOpacity,{key:n.id,onPress:()=>Profiles.showUserProfile({userId:n.id})},React.createElement(Text,{style:t.link},n.name,o&&",")):null}).filter(Boolean))}const{createThemedStyleSheet:createThemedStyleSheet$1}=StyleSheet$1,{ThemeColorMap:ThemeColorMap$4}=ColorMap;function PluginCard({plugin:e}){const t=getEnabledPlugins(),[n,s]=React.useState(t.includes(e.name)),o=StyleSheet$1.createThemedStyleSheet({container:{backgroundColor:ThemeColorMap$4.BACKGROUND_SECONDARY,borderRadius:5,borderLeftColor:e.color??"#524FBF",borderLeftWidth:5,marginBottom:15},name:{color:ThemeColorMap$4.HEADER_PRIMARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,fontSize:16},version:{color:ThemeColorMap$4.HEADER_SECONDARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,marginLeft:2.5},content:{height:"auto",paddingBottom:10,paddingLeft:10,paddingRight:10},actions:{justifyContent:"flex-end",flexDirection:"row",alignItems:"center"},description:{color:ThemeColorMap$4.HEADER_SECONDARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD},info:{marginLeft:-6,flexDirection:"row",alignItems:"center"},delete:{marginRight:7.5},trashIcon:{width:22,height:22,tintColor:"white"},settingsIcon:{width:22,height:22,tintColor:"white"}});return React.createElement(View,{style:o.container},React.createElement(View,null,React.createElement(FormRow,{label:()=>React.createElement(View,{style:o.info},React.createElement(Text,{style:o.name},e.name),e.version&&React.createElement(Text,{style:o.version},e.version," ",e.authors&&"by"),React.createElement(Authors,{authors:e.authors})),trailing:()=>React.createElement(View,{style:o.actions},React.createElement(TouchableOpacity,{style:o.delete,onPress:()=>{Navigation.push(PluginSettings)}},React.createElement(Image,{style:o.settingsIcon,source:Assets$1.getIDByName("settings")})),React.createElement(TouchableOpacity,{style:o.delete,onPress:()=>void uninstallPlugin(e.name)},React.createElement(Image,{style:o.trashIcon,source:Assets$1.getIDByName("ic_trash_filled_16px")})),React.createElement(FormSwitch,{value:n,onValueChange:r=>{s(r),Toasts.open({content:`${e.name} has been ${r?"enabled":"disabled"}.`}),r?enablePlugin(e.name):disablePlugin(e.name)}}))})),React.createElement(View,{style:o.content},React.createElement(Text,{style:o.description},e.description??"No description provided.")))}function HeaderRight$2(){const e=createThemedStyleSheet$1({header:{tintColor:ThemeColorMap$4.HEADER_PRIMARY,marginRight:15,width:18,height:18},wrapper:{marginRight:15,width:32,height:32}});return React.createElement(TouchableOpacity,{styles:e.wrapper,onPress:()=>{Alert.prompt("Install a plugin","Please enter the URL of the plugin to install.",t=>{if(!t.endsWith("js"))return Toasts.open({content:"Invalid URL for theme",source:Assets$1.getIDByName("ic_close_16px")});installPlugin(t,({data:n})=>{const s={icon:null,text:null};switch(n){case"fucky_wucky":s.text="Failed plugin installation.",s.icon=Assets$1.getIDByName("ic_close_16px");break;case"installed_plugin":s.text="Plugin has been installed.",s.icon=Assets$1.getIDByName("Check");break;case"overridden_plugin":s.text="Plugin has been overriden.",s.icon=Assets$1.getIDByName("Check");break}Toasts.open({content:s.text,source:s.icon})})})}},React.createElement(Image,{style:e.header,source:Assets$1.getIDByName("add_white")}))}const Search$1=getByProps("SearchBarNavWrapper",{default:!1});function Page$2(){const e=React.useState(null)[1],[t,n]=React.useState(getPlugins().sort((c,u)=>c.name.localeCompare(u.name))),[s,o]=React.useState(!1),[r,a]=React.useState(null);React.useEffect(()=>{function c(){e({})}return on$1("installed",c),on$1("uninstalled",c),()=>{off$1("installed",c),off$1("uninstalled",c)}},[]);const i=r?t.filter(c=>!!(c.name.toLowerCase().includes(r.toLowerCase())||c.description?.toLowerCase().includes(r.toLowerCase())||c.authors?.find?.(u=>(u.name??u).toLowerCase().includes(r.toLowerCase())))):t,l=createThemedStyleSheet$1({container:{flex:1,padding:5},notFound:{display:"flex",justifyContent:"center",alignItems:"center",alignSelf:"center",marginTop:"50%"},notFoundText:{marginTop:10,color:ThemeColorMap$4.TEXT_MUTED,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,textAlign:"center"},search:{marginTop:7.5,paddingRight:10,paddingLeft:10,backgroundColor:"none",borderBottomWidth:0}});return React.createElement(React.Fragment,null,React.createElement(Search$1.SearchBarNavWrapper,{style:l.search,placeholder:"Search plugins...",onChangeText:c=>a(c)}),React.createElement(View,{style:l.container},React.createElement(ScrollView,{style:l.container,refreshControl:React.createElement(RefreshControl,{refreshing:s,onRefresh:()=>{o(!0),n(getPlugins()),o(!1)}})},i.length?i.map(c=>React.createElement(PluginCard,{plugin:c})):r?React.createElement(View,{style:l.notFound},React.createElement(Image,{source:Assets$1.getIDByName("img_no_results_dark")}),React.createElement(Text,{style:l.notFoundText},"We searched far and wide."),React.createElement(Text,{style:{...l.notFoundText,marginTop:0}},"Unfortunately, no results were found.")):React.createElement(View,{style:l.notFound},React.createElement(Image,{source:Assets$1.getIDByName("img_connection_empty_dark")}),React.createElement(Text,{style:l.notFoundText},"You don't have any plugins."),React.createElement(Text,{style:{...l.notFoundText,marginTop:0}},"Install some by clicking the + icon!")))))}const{createThemedStyleSheet}=StyleSheet$1,{ThemeColorMap:ThemeColorMap$3}=ColorMap;function ThemeCard({theme:e}){const t=getTheme(),[n,s]=React.useState(t===e.name),o=StyleSheet$1.createThemedStyleSheet({container:{backgroundColor:ThemeColorMap$3.BACKGROUND_SECONDARY,borderRadius:5,borderLeftColor:e.color??"#524FBF",borderLeftWidth:5,marginBottom:15},name:{color:ThemeColorMap$3.HEADER_PRIMARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,fontSize:16},version:{color:ThemeColorMap$3.HEADER_SECONDARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,marginLeft:2.5},content:{height:"auto",paddingBottom:10,paddingLeft:10,paddingRight:10},actions:{justifyContent:"flex-end",flexDirection:"row",alignItems:"center"},description:{color:ThemeColorMap$3.HEADER_SECONDARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD},info:{marginLeft:-6,flexDirection:"row",alignItems:"center"},delete:{marginRight:7.5},trashIcon:{width:22,height:22}});return React.createElement(View,{style:o.container},React.createElement(View,null,React.createElement(FormRow,{label:()=>React.createElement(View,{style:o.info},React.createElement(Text,{style:o.name},e.name),e.version&&React.createElement(Text,{style:o.version},e.version," ",e.authors&&"by"),React.createElement(Authors,{authors:e.authors})),trailing:()=>React.createElement(View,{style:o.actions},React.createElement(TouchableOpacity,{style:o.delete,onPress:()=>{uninstallTheme(e.name,()=>{n&&Dialog.show({title:"Theme Uninstalled",body:"Uninstalling the theme you previously had applied requires a restart, would you like to restart Discord to remove the theme?",confirmText:"Yes",cancelText:"No",onConfirm:reloadDiscord})})}},React.createElement(Image,{style:o.trashIcon,source:Assets$1.getIDByName("ic_trash_filled_16px")})),React.createElement(FormSwitch,{value:n,onValueChange:r=>{s(r),Toasts.open({content:`${e.name} has been ${r?"enabled":"disabled"}.`}),r?(applyTheme(e.name),Dialog.show({title:"Theme Applied",body:"Applying a theme requires a restart, would you like to restart Discord to apply the theme?",confirmText:"Yes",cancelText:"No",onConfirm:reloadDiscord})):(removeTheme(),Dialog.show({title:"Theme Removed",body:"Removing the applied theme requires a restart, would you like to restart Discord to remove the applied theme?",confirmText:"Yes",cancelText:"No",onConfirm:reloadDiscord}))}}))})),React.createElement(View,{style:o.content},React.createElement(Text,{style:o.description},e.description??"No description provided.")))}function HeaderRight$1(){const e=createThemedStyleSheet({header:{tintColor:ThemeColorMap$3.HEADER_PRIMARY,marginRight:15,width:18,height:18},wrapper:{marginRight:15,width:32,height:32}});return React.createElement(TouchableOpacity,{styles:e.wrapper,onPress:()=>{Alert.prompt("Install a theme","Please enter the URL of a theme to install.",t=>{if(!t.endsWith("json"))return Toasts.open({content:"Invalid URL for theme",source:Assets$1.getIDByName("ic_close_16px")});try{installTheme(t,({data:n,restart:s})=>{const o={icon:null,text:null,restart:!1};switch(n){case"fucky_wucky":o.text="Failed theme installation.",o.icon=Assets$1.getIDByName("ic_close_16px");break;case"installed_theme":o.text="Theme has been installed.",o.icon=Assets$1.getIDByName("Check"),o.restart=s;break;case"overridden_theme":o.text="Theme has been overriden.",o.icon=Assets$1.getIDByName("Check"),o.restart=s;break}if(Toasts.open({content:o.text,source:o.icon}),o.restart)return Dialog.show({title:"Theme Replaced",body:"Replacing the theme you previously had applied requires a restart, would you like to restart Discord to reload the theme values?",confirmText:"Yes",cancelText:"No",onConfirm:reloadDiscord})})}catch(n){Toasts.open({content:n.message})}})}},React.createElement(Image,{style:e.header,source:Assets$1.getIDByName("add_white")}))}const Search=getByProps("SearchBarNavWrapper",{default:!1});function Page$1(){const e=React.useState(null)[1],[t,n]=React.useState(listThemes().sort((c,u)=>c.name.localeCompare(u.name))),[s,o]=React.useState(!1),[r,a]=React.useState(null);React.useEffect(()=>{function c(){e({})}return on("installed",c),on("uninstalled",c),()=>{off("installed",c),off("uninstalled",c)}},[]);const i=r?t.filter(c=>!!(c.name.toLowerCase().includes(r.toLowerCase())||c.description?.toLowerCase().includes(r.toLowerCase())||c.authors?.find?.(u=>(u.name??u).toLowerCase().includes(r.toLowerCase())))):t,l=createThemedStyleSheet({container:{flex:1,padding:5},notFound:{display:"flex",justifyContent:"center",alignItems:"center",alignSelf:"center",marginTop:"50%"},notFoundText:{marginTop:10,color:ThemeColorMap$3.TEXT_MUTED,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,textAlign:"center"},search:{marginTop:7.5,paddingRight:10,paddingLeft:10,backgroundColor:"none",borderBottomWidth:0}});return React.createElement(React.Fragment,null,React.createElement(Search.SearchBarNavWrapper,{style:l.search,placeholder:"Search themes...",onChangeText:c=>a(c)}),React.createElement(View,{style:l.container},React.createElement(ScrollView,{style:l.container,refreshControl:React.createElement(RefreshControl,{refreshing:s,onRefresh:()=>{o(!0),n(listThemes()),o(!1)}})},i.length?i.map(c=>React.createElement(ThemeCard,{theme:c})):r?React.createElement(View,{style:l.notFound},React.createElement(Image,{source:Assets$1.getIDByName("img_no_results_dark")}),React.createElement(Text,{style:l.notFoundText},"We searched far and wide."),React.createElement(Text,{style:{...l.notFoundText,marginTop:0}},"Unfortunately, no results were found.")):React.createElement(View,{style:l.notFound},React.createElement(Image,{source:Assets$1.getIDByName("img_connection_empty_dark")}),React.createElement(Text,{style:l.notFoundText},"You don't have any themes."),React.createElement(Text,{style:{...l.notFoundText,marginTop:0}},"Install some by clicking the + icon!")))))}const{ThemeColorMap:ThemeColorMap$2}=ColorMap;function ThemeIcon({height:e,width:t,...n}){const s=StyleSheet$1.createThemedStyleSheet({icon:{color:ThemeColorMap$2.INTERACTIVE_NORMAL,opacity:.75,marginLeft:.5}});return React.createElement(SVG.Svg,{viewBox:"0 0 24 24",style:{height:e,width:t,...s.icon},fill:"currentColor",...n},React.createElement(SVG.Path,{d:"M0 0h24v24H0z",fill:"none"}),React.createElement(SVG.Path,{d:"M20.5 11H19V7c0-1.1-.9-2-2-2h-4V3.5C13 2.12 11.88 1 10.5 1S8 2.12 8 3.5V5H4c-1.1 0-1.99.9-1.99 2v3.8H3.5c1.49 0 2.7 1.21 2.7 2.7s-1.21 2.7-2.7 2.7H2V20c0 1.1.9 2 2 2h3.8v-1.5c0-1.49 1.21-2.7 2.7-2.7 1.49 0 2.7 1.21 2.7 2.7V22H17c1.1 0 2-.9 2-2v-4h1.5c1.38 0 2.5-1.12 2.5-2.5S21.88 11 20.5 11z"}))}const{ThemeColorMap:ThemeColorMap$1}=ColorMap;function PluginIcon({height:e,width:t,...n}){const s=StyleSheet$1.createThemedStyleSheet({icon:{color:ThemeColorMap$1.INTERACTIVE_NORMAL,opacity:.75,marginLeft:.5}});return React.createElement(SVG.Svg,{viewBox:"0 0 24 24",style:{height:e,width:t,...s.icon},fill:"currentColor",...n},React.createElement(SVG.Path,{d:"M0 0h24v24H0z",fill:"none"}),React.createElement(SVG.Path,{d:"M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"}))}const ThemeColorMap=ColorMap.ThemeColorMap;function HeaderRight(){return null}function Page({settings:e}){const t=StyleSheet$1.createThemedStyleSheet({debugText:{color:ThemeColorMap.TEXT_MUTED}}),n={Twitter:getIDByName("img_account_sync_twitter_white"),GitHub:getIDByName("img_account_sync_github_white"),Addon:getIDByName("img_nitro_increase_guild_limit"),Checkmark:getIDByName("Check"),Discord:getIDByName("Discord")},s=[...window.plugins.enabled,...window.plugins.disabled],o=listThemes().map(r=>r.name);return React.createElement(ScrollView,null,React.createElement(KeyboardAvoidingView,{enabled:!0,behavior:"position",style:t.container,keyboardVerticalOffset:100,contentContainerStyle:{backfaceVisibility:"hidden"}},React.createElement(FormSection,{title:"Links"},React.createElement(FormRow,{label:"GitHub",leading:React.createElement(FormRow.Icon,{source:n.GitHub}),trailing:FormRow.Arrow,onPress:()=>Linking.openURL("https://github.com/enmity-mod")}),React.createElement(FormRow,{label:"Twitter",leading:React.createElement(FormRow.Icon,{source:n.Twitter}),trailing:FormRow.Arrow,onPress:()=>Linking.openURL("https://twitter.com/EnmityApp")})),React.createElement(FormSection,{title:"Debug"},React.createElement(FormRow,{label:"Discord Version",leading:React.createElement(FormRow.Icon,{source:n.Discord}),trailing:()=>React.createElement(Text,{style:t.debugText},getVersion()),onPress:()=>{Toasts.open({content:"Copied to clipboard",source:n.Checkmark}),Clipboard.setString(getVersion())}}),React.createElement(FormRow,{label:"Enmity Version",leading:React.createElement(FormRow.Icon,{source:{uri:"https://files.enmity.app/icon-64.png"}}),trailing:()=>React.createElement(Text,{style:t.debugText},window.enmity.version),onPress:()=>Linking.openURL(`https://github.com/enmity-mod/enmity/commit/${window.enmity.version}`)}),React.createElement(FormRow,{label:"Installed Plugins",leading:React.createElement(ThemeIcon,{width:24,height:24}),trailing:()=>React.createElement(Text,{style:t.debugText},s.length),onPress:()=>{Toasts.open({content:"Copied to clipboard",source:n.Checkmark}),Clipboard.setString(`**Plugins**: ${s.join(", ")}`)}}),React.createElement(FormRow,{label:"Installed Themes",leading:React.createElement(PluginIcon,{width:24,height:24}),trailing:()=>React.createElement(Text,{style:t.debugText},o.length),onPress:()=>{Toasts.open({content:"Copied to clipboard",source:n.Checkmark}),Clipboard.setString(`**Themes**: ${o.join(", ")}`)}}),React.createElement(FormRow,{label:"Automatically connect to debug websocket",trailing:React.createElement(FormSwitch,{value:e.getBoolean("autoConnectWS",!1),onValueChange:()=>e.toggle("autoConnectWS",!1)})}),e.getBoolean("autoConnectWS",!1)&&React.createElement(FormInput,{value:e.get("debugWSAddress","192.168.0.1:9090"),onChange:r=>e.set("debugWSAddress",r),title:"DEBUG IP"}))))}const Patcher$1=create$1("enmity-settings");function patchSettings(){patchScreens(),patchSettings$1()}function patchScreens(){Patcher$1.after(Scenes,"default",(e,t,n)=>({...n,Enmity:{key:"Enmity",title:"Enmity",render:connectComponent(Page,"enmity"),headerRight:HeaderRight},EnmityPlugins:{key:"Enmity Plugins",title:"Plugins",render:Page$2,headerRight:HeaderRight$2},EnmityThemes:{key:"Enmity Themes",title:"Themes",render:Page$1,headerRight:HeaderRight$1}}))}const patch={status:!1,forceUpdate:()=>{},navigator:null,handleSectionSelect:()=>{}};function patchSettings$1(){const e=getByTypeName("UserSettingsOverviewWrapper",{default:!1});Patcher$1.after(e,"default",(t,n,s)=>{const o=React.useState({})[1];patch.forceUpdate=()=>o({});const{navigation:r}=s.props;patch.navigator=r,!patch.status&&(Patcher$1.after(s.type.prototype,"render",(a,i,l)=>{const{children:c}=l.props,u=c.findIndex(d=>d.props.title===Locale.Messages.PREMIUM_SETTINGS);patch.handleSectionSelect=(...d)=>s.type.prototype.handleSectionSelect.apply(a,d),c.splice(u,0,React.createElement(React.Fragment,null,React.createElement(FormSection,{key:"Enmity",title:"Enmity"},React.createElement(FormRow,{label:"General",trailing:React.createElement(FormArrow,null),onPress:()=>void r.push("Enmity")}),React.createElement(FormDivider,null),React.createElement(FormRow,{label:"Plugins",trailing:React.createElement(FormArrow,null),onPress:()=>void r.push("EnmityPlugins")}),React.createElement(FormDivider,null),React.createElement(FormRow,{label:"Themes",trailing:React.createElement(FormArrow,null),onPress:()=>void r.push("EnmityThemes")}),React.createElement(FormDivider,null))))}),patch.status=!0)})}const Patcher=create$1("no-track"),blacklist=["useTrackExpressionPickerInlineStickersUpsell","useTrackThreadArchivalDurationUpsell","useAndTrackNonFriendDMAccept","StreamRTCAnalyticsContext","useAndTrackDMSpamAccept","useAnalyticsContext","trackExposure","SpotifyTrack","useAndTrack","TextTrack"],Trackers=getModules(e=>typeof e=="object"&&[...Object.keys(e),...Object.keys(e.__proto__),...Object.keys(e.prototype??{})].some(t=>~t.toLowerCase().indexOf("track")||~t.toLowerCase().indexOf("analytics"))),Reporters=getModules(e=>typeof e=="object"&&[...Object.keys(e),...Object.keys(e.__proto__),...Object.keys(e.prototype??{})].some(t=>~t.toLowerCase().indexOf("crashreport")));function patchTracking(){for(let t=0;t<Trackers.length;t++){const n=o=>(~o.toLowerCase().indexOf("track")||~o.toLowerCase().indexOf("analytics"))&&!blacklist.some(r=>o===r),s=Trackers[t];traverse(s,n),traverse(s.default,n)}for(let t=0;t<Reporters.length;t++){const n=o=>~o.toLowerCase().indexOf("crashreport")&&!blacklist.some(r=>o===r),s=Reporters[t];traverse(s,n),traverse(s.default,n)}const e={main:window.__SENTRY__?.hub,client:window.__SENTRY__?.hub?.getClient()};if(e.main&&e.client){e.client.close(0),e.main.getStackTop().scope.clear(),e.main.getScope().clear(),Patcher.instead(e.main,"addBreadcrumb",()=>{}),window.__oldConsole=window.console;for(const t of["debug","info","warn","error","log","assert"]){const n=console[t];if(!!n){if(n.__sentry_original__)console[t]=n.__sentry_original__;else if(n.__REACT_DEVTOOLS_ORIGINAL_METHOD__){const s=n.__REACT_DEVTOOLS_ORIGINAL_METHOD__.__sentry_original__;console[t].__REACT_DEVTOOLS_ORIGINAL_METHOD__=s}}}}}function traverse(e,t){if(!e||!t)return;const n=[...Object.keys(e),...Object.keys(e.__proto__),...Object.keys(e.prototype??{})].filter(t);for(let s=0;s<n.length;s++){const o=n[s],r=typeof(e[o]??e.__proto__[o]??e.prototype?.[o]);!~["function","object"].indexOf(r)||blacklist.some(a=>o===a)||(typeof e[o]=="object"?traverse(e[o],t):e.prototype?.[o]&&isConfigurable(e.prototype,o)?Patcher.instead(e.prototype,o,()=>Promise.resolve()):e.__proto__[o]&&isConfigurable(e.__proto__,o)?Patcher.instead(e.__proto__,o,()=>Promise.resolve()):e[o]&&isConfigurable(e,o)&&Patcher.instead(e,o,()=>Promise.resolve()))}}function isConfigurable(e,t){return!!Object.getOwnPropertyDescriptor(e,t).configurable}function initialize$3(){try{patchSettings()}catch(e){console.log("Failed to patch settings: ",e.message)}try{patchTracking()}catch(e){console.log("Failed to patch trackers: ",e.message)}try{patchDownloader()}catch(e){console.log("Failed to patch addon downloader: ",e.message)}}var CorePatches={initialize:initialize$3};Avatars.BOT_AVATARS.ENMITY="https://github.com/enmity-mod.png";function sendReply(e,t,n,s){const o=Clyde$1.createBotMessage(e,"");o.author.username=n??"Enmity",o.author.avatar=s?n:"ENMITY",s&&(Avatars.BOT_AVATARS[n]=s),typeof t=="string"?o.content=t:Object.assign(o,t),Messages.receiveMessage(e,o)}var Clyde=Object.freeze({__proto__:null,sendReply}),ApplicationCommandSectionType;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.Guild=1]="Guild",e[e.DM=2]="DM"})(ApplicationCommandSectionType||(ApplicationCommandSectionType={}));var ApplicationCommandType;(function(e){e[e.Chat=1]="Chat",e[e.User=2]="User",e[e.Message=3]="Message"})(ApplicationCommandType||(ApplicationCommandType={}));var ApplicationCommandInputType;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.BuiltInText=1]="BuiltInText",e[e.BuiltInIntegration=2]="BuiltInIntegration",e[e.Bot=3]="Bot",e[e.Placeholder=4]="Placeholder"})(ApplicationCommandInputType||(ApplicationCommandInputType={}));var ApplicationCommandPermissionType;(function(e){e[e.Role=1]="Role",e[e.User=2]="User"})(ApplicationCommandPermissionType||(ApplicationCommandPermissionType={}));var ApplicationCommandOptionType;(function(e){e[e.SubCommand=1]="SubCommand",e[e.SubCommandGroup=2]="SubCommandGroup",e[e.String=3]="String",e[e.Integer=4]="Integer",e[e.Boolean=5]="Boolean",e[e.User=6]="User",e[e.Channel=7]="Channel",e[e.Role=8]="Role",e[e.Mentionnable=9]="Mentionnable",e[e.Number=10]="Number"})(ApplicationCommandOptionType||(ApplicationCommandOptionType={}));var InteractionTypes;(function(e){e[e.ApplicationCommand=2]="ApplicationCommand",e[e.MessageComponent=3]="MessageComponent"})(InteractionTypes||(InteractionTypes={}));const list={id:"installed-plugins",applicationId:section.id,name:"plugins",displayName:"plugins",description:"List installed plugins",displayDescription:"List installed plugins",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,execute:(e,t)=>{const n=t.channel.id;if(getPlugins().length===0){sendReply(n,"No plugins installed.");return}const o=getEnabledPlugins(),r=getDisabledPlugins();let a="";o.length>0&&(a=`**Enabled plugins (${o.length})**:
`,a+=`> ${o.join(", ")}
`),r.length>0&&(a+=`**Disabled plugins (${r.length})**:
`,a+=`> ${r.join(", ")}`),sendReply(n,a)}},install={id:"install-plugin",applicationId:section.id,name:"install",displayName:"install",description:"Install a plugin",displayDescription:"Install a plugin",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,options:[{name:"plugin",displayName:"plugin",description:"Plugin url",displayDescription:"Plugin url",required:!0,type:ApplicationCommandOptionType.String}],execute:(e,t)=>{const n=e[0].value,s=t.channel.id;installPlugin(n,o=>{sendReply(s,o)})}},uninstall={id:"uninstall-plugin",applicationId:section.id,name:"uninstall",displayName:"uninstall",description:"Uninstall a plugin",displayDescription:"Uninstall a plugin",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,options:[{name:"plugin",displayName:"plugin",description:"Plugin name",displayDescription:"Plugin name",type:ApplicationCommandOptionType.String,required:!0}],execute:(e,t)=>{const n=e[0].value,s=t.channel.id;uninstallPlugin(n,o=>{sendReply(s,o)})}},disable={id:"disable-plugin",applicationId:section.id,name:"disable",displayName:"disable",description:"Disable a plugin",displayDescription:"Disable a plugin",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,options:[{name:"plugin",displayName:"plugin",description:"Plugin name",displayDescription:"Plugin name",type:ApplicationCommandOptionType.String,required:!0}],execute:(e,t)=>{const n=e[0].value,s=t.channel.id;disablePlugin(n,o=>{if(o==="yes"){sendReply(s,`**${n}** has been disabled.`);return}sendReply(s,`Error when disabling **${n}**.`)})}},enable={id:"enable-plugin",applicationId:section.id,name:"enable",displayName:"enable",description:"Enable a plugin",displayDescription:"Enable a plugin",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,options:[{name:"plugin",displayName:"plugin",description:"Plugin name",displayDescription:"Plugin name",type:ApplicationCommandOptionType.String,required:!0}],execute:(e,t)=>{const n=e[0].value,s=t.channel.id;enablePlugin(n,o=>{if(o==="yes"){sendReply(s,`**${n}** has been enabled.`);return}sendReply(s,`Error when enabling **${n}**.`)})}};var plugins=[list,install,uninstall,disable,enable];const themes={id:"list-themes",applicationId:section.id,name:"themes",displayName:"themes",description:"List available themes",displayDescription:"List available themes",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,execute:(e,t)=>{const n=listThemes();if(n.length===0){sendReply(t.channel.id,"No themes installed.");return}sendReply(t.channel.id,`**Installed themes (${n.length})**: ${n.join(", ")}`)}},apply={id:"apply-theme",applicationId:section.id,name:"apply",displayName:"apply",description:"Apply a theme",displayDescription:"Apply a theme",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,options:[{name:"name",displayName:"name",description:"Theme's name",displayDescription:"Theme's name",type:ApplicationCommandOptionType.String,required:!0,choices:listThemes().map(e=>({name:e.name,displayName:e.name,value:e.name}))}],execute:(e,t)=>{const n=e[0].value;getThemeByName(n)||sendReply(t.channel.id,"Theme couldn't be found."),applyTheme(n).then(o=>{sendReply(t.channel.id,o)})}},clear={id:"clear-theme",applicationId:section.id,name:"clear",displayName:"clear",description:"Remove applied theme",displayDescription:"Remove applied theme",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,execute:(e,t)=>{removeTheme().then(n=>{sendReply(t.channel.id,n)})}};var themes$1=[themes,apply,clear];const debug={id:"debug-command",name:"debug",displayName:"debug",description:"Print out your device information",displayDescription:"Print out your device information",applicationId:section.id,type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltInText,execute:()=>{let e=`**Debug Info:**
`;return e+=`> Enmity: ${window.enmity.version}
`,e+=`> Discord: ${getVersion()} (${getBuild()})
`,e+=`> Device: ${getDevice()}
`,e+=`> System: ${getSystemVersion()}
`,{content:e}}},reload={id:"reload-command",name:"reload",displayName:"reload",description:"Reload Discord",displayDescription:"Reload Discord",applicationId:section.id,type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,execute:function(e){reloadDiscord()}},getToken={id:"token-command",name:"token",displayName:"token",description:"Show your Discord's token",displayDescription:"Show your Discord's token",applicationId:section.id,type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,execute:function(e,t){sendReply(t.channel.id,Token.getToken())}};var utils=[debug,reload,getToken];const connect={id:"websocket-devtools",applicationId:section.id,name:"websocket",displayName:"websocket",description:"Connect to the websocket server",displayDescription:"Connect to the websocket server",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,options:[{name:"host",displayName:"host",description:"Host of the debugger",displayDescription:"Host of the debugger",type:ApplicationCommandOptionType.String,required:!0}],execute:e=>{const t=e[0].value;connectWebsocket(t)}},dump={id:"dump-command",applicationId:section.id,name:"dump",displayName:"dump",description:"Dump Discord's modules",displayDescription:"Dump Discord's modules",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,execute:function(e,t){const n=t.channel.id,s=window.modules;function o(r){if(typeof r=="function")return r.toString();if(Array.isArray(r))return r.map(o);if(typeof r=="object"){const a={};for(const i in r)a[i]=o(r[i]);return a}return r}for(const r of Object.keys(s))try{const a=s[r],i={id:r};if(!a.publicModule?.exports)continue;const l=a.publicModule.exports;for(const c of Object.keys(a.publicModule.exports))i[c]=o(l[c]);sendMessage(JSON.stringify(i,null,"	"))}catch(a){console.log(`Couldn't dump module ${r}`),console.log(a)}sendReply(n,"Modules has been dumped.")}};var websocket=[connect,dump];function initialize$2(){const e=[...plugins,...websocket,...utils,...themes$1];registerCommands("enmity",e)}var Commands={initialize:initialize$2};const API={modules:Modules,themer:Themes,patcher:Patcher$4,version:"9fd0dc5",plugins:Plugins,clyde:Clyde,commands:Commands$2,settings:Settings$2,components:Components,native:Native,assets:Assets$2,clipboard:Clipboard,storage:Storage,token:Token,users:Users,rest:REST,react:{...React,...Components,React},dialog:{showDialog:Dialog.show},toasts:{showToast:Toasts.open}};function initialize$1(){window.enmity=API}var API$1={API,initialize:initialize$1};function initialize(){WebSocket$1.initialize(),API$1.initialize(),CorePatches.initialize(),Commands.initialize()}var Enmity={initialize};try{Enmity.initialize()}catch(e){alert(`Enmity failed to initialize: ${e.message}`),console.error(e)}
