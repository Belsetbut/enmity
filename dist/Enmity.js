const modules$1={Constants:{props:["ActionTypes"]},Clipboard:{props:["setString","getString"]},Assets:{props:["registerAsset"]},Messages:{props:["receiveMessage","sendMessage"]},Clyde:{props:["createBotMessage"]},Avatars:{props:["BOT_AVATARS"]},Native:{props:["NativeModules"],export:"NativeModules"},React:{props:["createElement"]},Dispatcher:{props:["dirtyDispatch"]},Storage:{props:["getItem"]},Toasts:{props:["open","close"],ensure:e=>!e.openLazy&&!e.startDrag&&!e.init&&!e.openReplay},Dialog:{props:["show","openLazy","open","close"]},Token:{props:["getToken"]},REST:{props:["getAPIBaseURL"]},Settings:{props:["watchKeys"]},Users:{props:["getCurrentUser"]},Subscriptions:{props:["getPremiumTypeSubscription"]},Navigation:{props:["pushLazy"]},NavigationNative:{props:["NavigationContainer"]},NavigationStack:{props:["createStackNavigator"]},Theme:{props:["theme"]},Linking:{props:["openURL"]},StyleSheet:{props:["createThemedStyleSheet"]},ColorMap:{props:["ThemeColorMap"]},Components:{multiple:!0,props:{Forms:["Form","FormSection"],General:["Button","Text","View"]}},Locale:{props:["Messages"]},Profiles:{props:["showUserProfile"]},Lodash:{props:["debounce","throttle"]},Logger:{name:"Logger"},Flux:{props:[["Store","connectStores"],["useStateFromStoresObject"]]},SVG:{props:["Svg"]},Scenes:{name:"getScreens",default:!1}},common={},blacklist$1=[e=>e>=951&&e<=1006,125,203,433,434,445,446,457],filters={byProps:(...e)=>t=>e.every(n=>t[n]!==void 0),byName:(e,t=!0)=>n=>n?t?typeof n=="function"&&n.name===e:typeof n.default=="function"&&n.default.name===e:!1,byTypeName:(e,t=!0)=>n=>n?t?typeof n=="function"&&n.name===e:typeof n.default=="function"&&n.default.type?.name===e:!1,byDisplayName:(e,t=!0)=>n=>n?t?typeof n=="function"&&n.name===e:typeof n.default=="function"&&n.default.name===e:!1,byTypeString:(...e)=>t=>t?.default?e.every(n=>t.default.toString?.()?.includes?.(n)):!1,byDefaultString:(...e)=>t=>t?.default?e.every(n=>t.default.toString?.()?.includes?.(n)):!1,byString:(...e)=>t=>e.every(n=>t.toString?.()?.includes?.(n))},getters=[];Object.entries(modules$1).map(([e,t])=>{if(t.multiple)Object.entries(t.props).map(([n,r])=>{getters.push({id:n,filter:o=>filters.byProps(...r)(o),submodule:e})});else if(t.props)if(t.props.every(n=>Array.isArray(n))){const n=[];getters.push({id:e,filter:r=>{const o=t.props.some(s=>s.every(i=>r[i]));return o&&t.ensure&&!t.ensure(r)?!1:(o&&n.push(r),o)},map:Object.assign({},...n)})}else getters.push({id:e,filter:n=>{const r=filters.byProps(...t.props)(n);return r&&t.ensure&&t.ensure(n)===!1?!1:r},map:t.export});else t.displayName?getters.push({id:e,filter:filters.byDisplayName(t.displayName,t.default),map:t.export}):t.name?getters.push({id:e,filter:filters.byName(t.name,t.default),map:t.export}):t.filter&&getters.push({id:e,filter:t.filter,map:t.export})});const results=bulk(...getters.map(({filter:e})=>e));getters.map(({id:e,map:t,submodule:n},r)=>{let o=i=>i;if(typeof t=="string")o=i=>i[t];else if(Array.isArray(t)){let i={};o=a=>{for(const l of t)i[l]=a[l];return i}}const s=o(results[r]);n?(common[n]??={},common[n][e]=s):common[e]=s});function getModule(e,{all:t=!1,traverse:n=!0,defaultExport:r=!0}={}){if(typeof e!="function")return null;const o=[],s=function(i,a){try{return e(i,a)}catch{return!1}};for(const i in modules){if(blacklist$1.some(l=>typeof l=="function"?l(i):l===Number(i)))continue;modules[i].isInitialized||__r(Number(i));const a=modules[i].publicModule.exports;if(!(!a||a===window)){if(typeof a=="object"){if(s(a,i)){if(!t)return a;o.push(a)}if(a.__esModule&&a.default&&s(a.default,i)){const l=r?a.default:a;if(!t)return l;o.push(l)}if(n&&a.__esModule){for(const l in a)if(a[l]!==void 0&&s(a[l],i)){if(!t)return a[l];o.push(a[l])}}}else if(typeof a=="function"){if(!s(a,i))continue;if(!t)return a;o.push(a)}}}return t?o:o[0]}function getModules(e){return getModule(e,{all:!0})}function bulk(...e){const t=new Array(e.length),n=e.map(r=>o=>{try{return r(o)}catch{return!1}});return getModule(r=>{for(let o=0;o<n.length;o++){const s=n[o];typeof s!="function"||!s(r)||t[o]!=null||(t[o]=r)}return t.filter(String).length===e.length}),t}function getByProps(...e){const[t,{bulk:n=!1,...r}]=parseOptions(e);if(n){const o=t.map(s=>Array.isArray(s)?o.byProps(...s):o.byProps(s)).concat({...r});return n(...o)}return getModule(filters.byProps(...t),r)}function getByDisplayName(...e){const[t,{bulk:n=!1,default:r=!0,...o}]=parseOptions(e);if(n){const s=t.map(filters.byDisplayName).concat({defaultExport:r,...o});return n(...s)}return getModule(filters.byDisplayName(t[0]),{defaultExport:r,...o})}function getByTypeName(...e){const[t,{bulk:n=!1,default:r=!0,...o}]=parseOptions(e);if(n){const s=t.map(filters.byTypeName).concat({defaultExport:r,...o});return n(...s)}return getModule(filters.byTypeName(t[0]),{defaultExport:r,...o})}function getByName$1(...e){const[t,{bulk:n=!1,default:r=!0,...o}]=parseOptions(e);if(n){const s=t.map(filters.byName).concat({defaultExport:r,...o});return n(...s)}return getModule(filters.byName(t[0]),{defaultExport:r,...o})}function getByDefaultString(...e){const[t,{bulk:n=!1,...r}]=parseOptions(e);if(n){const o=t.map(s=>Array.isArray(s)?o.byDefaultString(...s):o.byDefaultString(s)).concat({...r});return n(...o)}return getModule(filters.byDefaultString(...t),r)}function getByTypeString(...e){const[t,{bulk:n=!1,...r}]=parseOptions(e);if(n){const o=t.map(s=>Array.isArray(s)?o.byTypeString(...s):o.byTypeString(s)).concat({...r});return n(...o)}return getModule(filters.byTypeString(...t),r)}function getByString(...e){const[t,{bulk:n=!1,...r}]=parseOptions(e);if(n){const o=t.map(s=>Array.isArray(s)?o.byString(...s):o.byString(s)).concat({...r});return n(...o)}return getModule(filters.byString(...t),r)}function getByKeyword(...e){const[[t],{caseSensitive:n=!1,all:r=!1,...o}]=parseOptions(e);return getModule(s=>{const i=[...Object.keys(s),...Object.keys(s.__proto__)];for(let a=0;a<i.length;a++){const l=i[a];if(n){if(~l.indexOf(t))return!0}else{const c=t.toLowerCase();if(~l.toLowerCase().indexOf(c))return!0}}return!1},{all:r,...o})}function parseOptions(e,t=n=>typeof n=="object"&&!Array.isArray(n)){return[e,t(e[e.length-1])?e.pop():{}]}var Modules=Object.freeze({__proto__:null,common,filters,getModule,getModules,bulk,getByProps,getByDisplayName,getByTypeName,getByName:getByName$1,getByDefaultString,getByTypeString,getByString,getByKeyword});const{Clipboard,Assets:Assets$3,Messages,Clyde:Clyde$1,Avatars,Native,Dispatcher,Storage,Toasts,Dialog,Token,REST,Settings:Settings$3,Users,Theme,Linking,StyleSheet:StyleSheet$1,ColorMap,Components:Components$1,Locale,Constants,Profiles,Logger:Logger$1,Lodash,Flux,SVG,Scenes,Subscriptions,Navigation,NavigationNative,NavigationStack}=common;common.React;const patches$1=[];function getPatchesByCaller(e){if(!e)return[];const t=[];for(const n of patches$1){const r=[...n.patches.before,...n.patches.instead,...n.patches.after];for(const o of r)o.caller===e&&t.push(o)}return t}function unpatchAll$1(e){const t=getPatchesByCaller(e);if(!!t.length)for(const n of t)n.unpatch()}function override(e){return function(){if(!e?.patches?.before.length&&!e?.patches?.after.length&&!e?.patches?.instead.length&&!patches$1.find(i=>i.mdl===e.mdl&&i.func===e.func))return e.unpatch(),new.target?new e.original(...arguments):e.original.apply(this,arguments);let t,n=arguments;const r=e.patches.before;for(let i=0;i<r.length;i++){const a=r[i];if(!!a)try{const l=a.callback(this,n,e.original.bind(this));Array.isArray(l)&&(n=l),a.once&&a.unpatch()}catch(l){console.error(`Could not fire before patch for ${e.func} of ${a.caller}`),console.error(l)}}const o=e.patches.instead;if(!o.length)new.target?t=new e.original(...n):t=e.original.apply(this,n);else for(let i=0;i<o.length;i++){const a=o[i];if(!!a)try{const l=a.callback(this,n,e.original.bind(this));typeof l<"u"&&(t=l),a.once&&a.unpatch()}catch(l){console.error(`Could not fire instead patch for ${e.func} of ${a.caller}`),console.error(l)}}const s=e.patches.after;for(let i=0;i<s.length;i++){const a=s[i];if(!!a)try{a.caller.includes("downloader")&&console.log(a);const l=a.callback(this,n,t,c=>t=c);typeof l<"u"&&(t=l),a.once&&a.unpatch()}catch(l){console.error(`Could not fire after patch for ${e.func} of ${a.caller}`),console.error(l)}}return t}}function push$1([,e,t,,n,r]){const o={mdl:e,func:t,id:patches$1?.[n]?.length??0,original:e[t],once:r,unpatch:()=>{o.mdl[o.func]=o.original,o.patches={before:[],after:[],instead:[]}},patches:{before:[],after:[],instead:[]}};e[t]=override(o);const s=Object.getOwnPropertyDescriptors(o.original);return delete s.length,Object.defineProperties(e[t],{...s,toString:{value:()=>o.original.toString(),configurable:!0,enumerable:!1},__original:{value:o.original,configurable:!0,enumerable:!1}}),patches$1.push(o),o}function get$2([,e,t]){const n=patches$1.find(r=>r.mdl===e&&r.func===t);return n||push$1(...arguments)}function patch$1(e,t,n,r,o="after",s=!1){if(!e||typeof e!="string")throw new TypeError('first argument "caller" must be of type string');if(!t||!["function","object"].includes(typeof t))throw new TypeError('second argument "mdl" must be of type function or object');if(!n||typeof n!="string")throw new TypeError('third argument "func" must be of type string');if(!r||typeof r!="function")throw new TypeError('fourth argument "callback" must be of type function');if(!o||typeof o!="string"||!["after","before","instead"].includes(o))throw new TypeError('fifth argument "type" must be of type string and any of the three: after, before, instead');if(typeof t[n]>"u")throw new ReferenceError(`function ${n} does not exist on the second argument (object or function)`);const i=get$2(arguments),a={caller:e,once:s,type:o,id:i.patches?.[o]?.length??0,callback:r,unpatch:()=>{const l=i.patches?.[o].findIndex(u=>u.id===a.id);if(~l&&i.patches?.[o].splice(l,1),i.patches?.before.length||i.patches?.after.length||i.patches?.instead.length)return;const c=patches$1.findIndex(u=>u.mdl==t&&u.func==n);!c||(patches$1[c]?.unpatch(),patches$1.splice(c,1))}};return i.patches[o]??=[],i.patches[o].push(a),a.unpatch}function before$1(e,t,n,r,o=!1){return patch$1(e,t,n,r,"before",o)}function instead$1(e,t,n,r,o=!1){return patch$1(e,t,n,r,"instead",o)}function after$1(e,t,n,r,o=!1){return patch$1(e,t,n,r,"after",o)}function create$1(e){return{getPatchesByCaller,before:(t,n,r)=>before$1(e,t,n,r),instead:(t,n,r)=>instead$1(e,t,n,r),after:(t,n,r)=>after$1(e,t,n,r),unpatchAll:()=>unpatchAll$1(e)}}var patcher={create:create$1,before:before$1,instead:instead$1,after:after$1,unpatchAll:unpatchAll$1,patches:patches$1},Patcher$4=Object.freeze({__proto__:null,create:create$1,before:before$1,instead:instead$1,after:after$1,unpatchAll:unpatchAll$1,patches:patches$1,default:patcher});const assets={};patcher.after("enmity-assets",Assets$3,"registerAsset",(e,[t],n)=>{assets[t.name]={...t,id:n}});for(let e=1;;e++){const t=Assets$3.getAssetByID(e);if(!t)break;assets[t.name]||(assets[t.name]={...t,id:e})}function find(e){return Object.values(assets).find(e)}function getByName(e){return assets[e]}function getByID(e){return Assets$3.getAssetByID(e)}function getIDByName(e){return assets[e]?.id}var Assets$1={assets,getByName,getByID,getIDByName},Assets$2=Object.freeze({__proto__:null,assets,find,getByName,getByID,getIDByName,default:Assets$1});const settings=Settings$3.get("enmity")??{};function getSetting(e,t,n){return settings[e]?.[t]??n}function get$1(e){return settings[e]??{}}function getAll(){return settings}const Events$2={ENMITY_GET_SETTING:({file:e,setting:t,defaults:n})=>settings[e][t]??n,ENMITY_SET_SETTING:({file:e,setting:t,value:n})=>{settings[e]||(settings[e]={}),n==null?delete settings[e][t]:settings[e][t]=n},ENMITY_TOGGLE_SETTING:({file:e,setting:t,defaults:n})=>{settings[e]||(settings[e]={}),settings[e][t]===void 0?settings[e][t]=!Boolean(n):settings[e][t]=!Boolean(settings[e][t])}},store=new Flux.Store(Dispatcher,Events$2);store.addChangeListener(Lodash.debounce(()=>Settings$3.set({enmity:settings}),200));var Manager={store,getAll,getSetting,get:get$1},React=common.React;const listeners={};Dispatcher.subscribe("ENMITY_SET_SETTING",ENMITY_SET_SETTING),Dispatcher.subscribe("ENMITY_TOGGLE_SETTING",ENMITY_TOGGLE_SETTING);function ENMITY_SET_SETTING(e){return handleSettingsUpdate({...e,type:"set"})}function ENMITY_TOGGLE_SETTING(e){return handleSettingsUpdate({...e,type:"toggle"})}function handleSettingsUpdate({file:e,type:t,...n}){const r=listeners[e];if(!!r)for(const o of r.values())o({...n})}function set(e,t,n){if(!e||typeof e!="string")throw new TypeError("the first argument file must be of type string");if(!t||typeof t!="string")throw new TypeError("the second argument setting must be of type string");return Dispatcher.dirtyDispatch({type:"ENMITY_SET_SETTING",file:e,setting:t,value:n})}function get(e,t,n){if(!e||typeof e!="string")throw new TypeError("the first argument file must be of type string");if(!t||typeof t!="string")throw new TypeError("the second argument setting must be of type string");return Manager.getSetting(e,t,n)}function getBoolean(e,t,n){if(!e||typeof e!="string")throw new TypeError("the first argument file must be of type string");if(!t||typeof t!="string")throw new TypeError("the second argument setting must be of type string");return Boolean(Manager.getSetting(e,t,n))}function toggle(e,t,n){if(!e||typeof e!="string")throw new TypeError("the first argument file must be of type string");if(!t||typeof t!="string")throw new TypeError("the second argument setting must be of type string");if(n===void 0||typeof n!="boolean")throw new TypeError("the third argument defaults must be of type boolean");return Dispatcher.dirtyDispatch({type:"ENMITY_TOGGLE_SETTING",file:e,setting:t,defaults:n})}function connectComponent(e,t){if(!e||!["function","object"].includes(typeof e))throw new TypeError("the first argument component must be of type function or object");if(!t||typeof t!="string")throw new TypeError("the second argument file must be of type string");const n=r=>{const o=React.useState({})[1];return React.useEffect(()=>{function s(){o({})}return subscribe(t,s),()=>unsubscribe(t,s)},[]),React.createElement(e,{...r,settings:makeStore(t)})};return e.displayName&&(n.displayName=e.displayName),e.name&&(n.name=`Connected${e.name}`),n}function makeStore(e){if(!e||typeof e!="string")throw new TypeError("the first argument file must be of type string");return{settings:Manager.get(e),set:(t,n)=>set(e,t,n),get:(t,n)=>get(e,t,n),toggle:(t,n)=>toggle(e,t,n),getBoolean:(t,n)=>getBoolean(e,t,n)}}function subscribe(e,t){if(!e||typeof e!="string")throw new TypeError("the first argument file must be of type string");if(!t||typeof t!="function")throw new TypeError("the second argument callback must be of type function");listeners[e]??=new Set,listeners[e].add(t)}function unsubscribe(e,t){if(!e||typeof e!="string")throw new TypeError("the first argument file must be of type string");if(!t||typeof t!="function")throw new TypeError("the second argument callback must be of type function");listeners[e]?.delete(t),listeners[e]?.size===0&&delete listeners[e]}function connectStores(e){return Flux.connectStores([Manager.store],()=>({settings:makeStore(e)}))}var Settings$1={connectComponent,connectStores,unsubscribe,subscribe,makeStore,listeners,toggle,get,set},Settings$2=Object.freeze({__proto__:null,listeners,set,get,getBoolean,toggle,connectComponent,makeStore,subscribe,unsubscribe,connectStores,default:Settings$1,settings,store});const Logger=getByName$1("Logger"),EnmityLogger=new Logger("Enmity");let socket;function connectWebsocket(host){console.log("Connecting to debug WebSocket"),socket!==void 0&&socket.readyState!==WebSocket.CLOSED&&(socket.close(),socket=null);const address=Boolean(Settings$1.get("enmity","autoConnectWS",!1))&&Settings$1.get("enmity","debugWSAddress");!address&&!host||(socket=new WebSocket(`ws://${host??address}`),socket.addEventListener("open",()=>{console.log("Connected with debug websocket"),Toasts.open({content:"Connected to the websocket server."})}),socket.addEventListener("error",e=>{console.log(`Error with debug websocket: ${e.message}`),Toasts.open({content:"An error occured with the websocket connection."})}),socket.addEventListener("close",e=>{console.log(`Error with debug websocket: ${e.message}`),Toasts.open({content:"The websocket connection has been closed."})}),socket.addEventListener("message",message=>{try{console.log(eval(message.data))}catch(e){console.error(e)}}))}function initialize$4(){const e=nativeLoggingHook;globalThis.nativeLoggingHook=function(t,n){return socket?.readyState===WebSocket.OPEN&&socket.send(JSON.stringify({level:n,message:t})),EnmityLogger.log(t),e.apply(this,arguments)},Settings$1.get("enmity","autoConnectWS",!1)&&connectWebsocket()}function sendMessage(e){socket?.readyState===WebSocket.OPEN&&socket.send(e)}var WebSocket$1={initialize:initialize$4,sendMessage,connectWebsocket,socket};const AddonChannels={Plugins:["961782195767365732"],Themes:["961782176062509117","968223084643487744"]},Patcher$3=create$1("enmity-commands"),[Commands$1,Discovery,Assets]=bulk(filters.byProps("getBuiltInCommands"),filters.byProps("useApplicationCommandsDiscoveryState"),filters.byProps("getApplicationIconURL"));let commands=[];const section={id:"enmity",type:1,name:"Enmity",icon:"https://files.enmity.app/icon.png"};Patcher$3.after(Commands$1,"getBuiltInCommands",(e,t,n)=>[...n,...commands.values()]),Patcher$3.after(Assets,"getApplicationIconURL",(e,[t],n)=>{if(t.id==="enmity")return section.icon}),Patcher$3.after(Discovery,"useApplicationCommandsDiscoveryState",(e,[,,,t],n)=>{if(t!==!1)return n;if(!n.discoverySections.find(o=>o.key===section.id)&&commands.length){const o=[...commands.values()];n.discoveryCommands.push(...o),n.commands.push(...o.filter(s=>!n.commands.some(i=>i.name===s.name))),n.discoverySections.push({data:o,key:section.id,section}),n.sectionsOffset.push(commands.length)}!n.applicationCommandSections.find(o=>o.id===section.id)&&commands.length&&n.applicationCommandSections.push(section);const r=n.discoverySections.findIndex(o=>o.key==="-2");if(n.discoverySections[r]?.data){const o=n.discoverySections[r];o.data=o.data.filter(s=>!s.__enmity),o.data.length===0&&n.discoverySections.splice(r,1)}});function registerCommands(e,t){t.map(n=>{n.__enmity=!0,n.caller=e}),commands.push(...t)}function unregisterCommands(e){commands=commands.filter(t=>t.caller!==e)}var Commands$2=Object.freeze({__proto__:null,section,registerCommands,unregisterCommands});function uuid(e=10){let t="";do{const n=Math.random()*16|0;t+=(t.length==12?4:t.length==16?n&3|8:n).toString(16)}while(t.length<e);return t}const replies={};Linking.addEventListener("url",e=>{let t=e.url;t=decodeURIComponent(t.replace("com.hammerandchisel.discord://",""));try{const n=JSON.parse(t);if(n.data===void 0)return;replies[n.id]&&(replies[n.id](n.data),delete replies[n.id])}catch{return}});function sendCommand(e,t=[],n){const r=uuid();Linking.openURL(`com.hammerandchisel.discord://enmity?id=${r}&command=${e}&params=${t.join(",")}`).then(()=>{n&&(replies[r]=n)})}const EventEmitter$1=getByProps("EventEmitter").EventEmitter;let plugins$1=[],enabled=window.plugins.enabled,disabled=window.plugins.disabled;const Events$1=new EventEmitter$1;function registerPlugin(e){!e||typeof e!="object"||(e.onEnable=()=>{try{e.onStart(),e.commands&&registerCommands(e.name,e.commands),console.log(`${e.name} has been enabled`)}catch(t){console.log(`${e.name} failed to load`,t.message)}},e.onDisable=()=>{try{if(e.patches)for(const t of e.patches)t.unpatchAll();e.commands&&unregisterCommands(e.name),e.onStop(),console.log(`${e.name} has been disabled`)}catch(t){console.log(`${e.name} failed to disable`,t.message)}},enabled.includes(e.name)&&e.onEnable(),disabled.includes(e.name)&&e.onDisable(),getPlugin(e.name)||plugins$1.push(e))}const on$1=Events$1.on.bind(Events$1),once$1=Events$1.once.bind(Events$1),off$1=Events$1.off.bind(Events$1);function getPlugin(e){return plugins$1.find(t=>t.name===e)}function getPlugins(){return plugins$1}function getEnabledPlugins(){return enabled}function getDisabledPlugins(){return disabled}function disablePlugin(e,t=!1,n){if(enabled.includes(e)){const r=enabled.indexOf(e);~r&&enabled.splice(r,1)}if(t&&disabled.includes(e)){const r=disabled.indexOf(e);~r&&disabled.splice(r,1)}return t||disabled.push(e),getPlugin(e).onDisable(),new Promise(r=>{sendCommand("disable-plugin",[e],(...o)=>{n&&n(...o),r(...o)})})}function enablePlugin(e,t){if(disabled.includes(e)){const n=disabled.indexOf(e);~n&&disabled.splice(n,1)}return enabled.push(e),getPlugin(e).onEnable(),new Promise(n=>{sendCommand("enable-plugin",[e],(...r)=>{t&&t(...r),n(...r)})})}async function evalPlugin(url,enable=!1,update){try{const response=await REST.get(url),code=response.text,name=url.split("/").pop().split(".")[0],id=Number(Object.keys(window.modules).pop())+1,wrapper=`__d(function(...args) {
        try {
          ${code}
        } catch(err) {
          console.log(err);
        }
      }, ${id}, []);
      __r(${id})`;try{eval(wrapper),enable&&!enabled.includes(name)&&await enablePlugin(name)}catch(e){console.log("Failed to eval plugin instance",e.message)}return update&&update(),name}catch(e){console.log("Failed to eval plugin instance",e.message)}}function installPlugin(e,t,n){const r=e.split("/").pop().split(".")[0];return new Promise(o=>{sendCommand("install-plugin",[e],s=>{function i(){evalPlugin(e,!0).then(a=>{const l={name:a,data:s,url:e};Events$1.emit("installed"),t&&t(l),n(),o(l)})}return s==="overridden_plugin"?disablePlugin(r,!0).then(i):i()})})}function uninstallPlugin(e,t){return new Promise(n=>{disablePlugin(e),sendCommand("uninstall-plugin",[e],r=>{enabled=enabled.filter(s=>s!==e),disabled=disabled.filter(s=>s!==e);const o=plugins$1.findIndex(s=>s.name===e);o>-1&&plugins$1.splice(o,1),Events$1.emit("uninstalled"),t&&t(r),n(r)})})}var Plugins=Object.freeze({__proto__:null,registerPlugin,on:on$1,once:once$1,off:off$1,getPlugin,getPlugins,getEnabledPlugins,getDisabledPlugins,disablePlugin,enablePlugin,evalPlugin,installPlugin,uninstallPlugin});function reloadDiscord(){return Native.BundleUpdaterManager.reload()}function getVersion(){return Native.InfoDictionaryManager.Version}function getBuild(){return Native.InfoDictionaryManager.Build}function getDevice(){return Native.DCDDeviceManager.device}function getSystemVersion(){return Native.DCDDeviceManager.systemVersion}let theme=window.themes?.theme??"",themes$2=window.themes?.list??[];const EventEmitter=getByProps("EventEmitter").EventEmitter,Events=new EventEmitter,on=Events.on.bind(Events),once=Events.once.bind(Events),off=Events.off.bind(Events);function getTheme(){return theme}function getThemeByName(e){return themes$2.find(t=>t.name===e)}function listThemes(){return themes$2}async function installTheme(e,t){return new Promise(n=>{sendCommand("install-theme",[e],r=>{REST.get(e).then(o=>{const s=JSON.parse(o.text);if(!s)throw new Error("Invalid theme structure");const i=themes$2.findIndex(l=>l.name===s.name);i>-1&&themes$2.splice(i,1),themes$2.push(s);const a={theme:s,url:e,data:r,restart:getTheme()===s.name};t&&t(a),Events.emit("installed"),n(a)})})})}function applyTheme(e,t){return new Promise(n=>{sendCommand("apply-theme",[e,Theme.theme],r=>{theme=e,t&&t(r),n(r)})})}function removeTheme(e){return new Promise(t=>{sendCommand("remove-theme",[],n=>{theme="",e&&e(n),t(n)})})}async function uninstallTheme(e,t){return getTheme()===e&&removeTheme(),new Promise(n=>{sendCommand("uninstall-theme",[e],r=>{const o=themes$2.findIndex(s=>s.name===e);o>-1&&themes$2.splice(o,1),Events.emit("uninstalled"),t&&t(r),n(r)})})}var Themes=Object.freeze({__proto__:null,on,once,off,getTheme,getThemeByName,listThemes,installTheme,applyTheme,removeTheme,uninstallTheme});const Patcher$2=patcher.create("enmity-sheet-patcher"),patches={},Opener=getByProps("openLazy");Patcher$2.before(Opener,"openLazy",(e,[t,n,r,o])=>{!patches[n]||(console.log(o),t.then(s=>{const i=Patcher$2.after(s,"default",(a,l,c)=>{for(let u=0;u<patches[n].length;u++){const d=patches[n][u];if(d.applied)continue;const m=d.callback;patcher[d.type](d.caller,c.type,"render",(p,g,h)=>m.apply(p,[p,g,h])),d.applied=!0}return i(),c});return s}))});function before(e,t,n){validateArguments(e,t,n),push("before",e,t,n)}function after(e,t,n){validateArguments(e,t,n),push("after",e,t,n)}function instead(e,t,n){validateArguments(e,t,n),push("instead",e,t,n)}function unpatchAll(e){for(const t in patches){const n=patches[t];patches[n]=n.filter(r=>r.caller!==e)}return Patcher$2.unpatchAll(e)}function create(e){return{before:(t,n)=>before(e,t,n),after:(t,n)=>after(e,t,n),instead:(t,n)=>instead(e,t,n),unpatchAll:()=>unpatchAll(e)}}function push(e,t,n,r){setTimeout(()=>console.log(r.name),2e3),patches[n]??=[],patches[n].push({type:e,caller:t,sheet:n,callback:r,applied:!1})}function validateArguments(e,t,n){if(!e||typeof e!="string")throw new TypeError("first argument caller does not exist or is not of type string");if(!t||typeof t!="string")throw new TypeError("second argument menu does not exist or is not of type string");if(!n||typeof n!="function")throw new TypeError("third argument callback does not exist or is not of type function")}var SheetPatcher={patches,unpatchAll,instead,create,before,after};const{Alert,Button,FlatList,Image,ImageBackground,KeyboardAvoidingView,Modal,Pressable,RefreshControl,ScrollView,SectionList,StatusBar,StyleSheet,Switch,Text,TextInput,TouchableHighlight,TouchableOpacity,TouchableWithoutFeedback,Touchable,View,VirtualizedList}=Components$1.General,{Form,FormArrow,FormCTA,FormCTAButton,FormCardSection,FormCheckbox,FormDivider,FormHint,FormIcon,FormInput,FormLabel,FormRadio,FormRow,FormSection,FormSelect,FormSubLabel,FormSwitch,FormTernaryCheckBox,FormText,FormTextColors,FormTextSizes}=Components$1.Forms;var Components=Object.freeze({__proto__:null,Alert,Button,FlatList,Image,ImageBackground,KeyboardAvoidingView,Modal,Pressable,RefreshControl,ScrollView,SectionList,StatusBar,StyleSheet,Switch,Text,TextInput,TouchableHighlight,TouchableOpacity,TouchableWithoutFeedback,Touchable,View,VirtualizedList,Form,FormArrow,FormCTA,FormCTAButton,FormCardSection,FormCheckbox,FormDivider,FormHint,FormIcon,FormInput,FormLabel,FormRadio,FormRow,FormSection,FormSelect,FormSubLabel,FormSwitch,FormTernaryCheckBox,FormText,FormTextColors,FormTextSizes});const Icon=getByTypeName("Icon"),{ThemeColorMap:ThemeColorMap$7}=ColorMap;function patchDownloader(){SheetPatcher.after("enmity-downloader","MessageLongPressActionSheet",(e,[{channel:t,message:n},r])=>{const o=StyleSheet$1.createThemedStyleSheet({icon:{color:ThemeColorMap$7.INTERACTIVE_NORMAL}});if(AddonChannels.Plugins.includes(t.id)){const s=n.content.match(/http(|s).+.js/gmi)?.[0];if(!s)return;r.unshift(React.createElement(FormRow,{label:"Install Plugin",leading:React.createElement(Icon,{...o.icon,size:"medium",disableColor:!1,source:getIDByName("ic_download_24px")}),onPress:()=>{installPlugin(s,({data:i})=>{const a={icon:null,text:null};switch(i){case"fucky_wucky":a.text="Failed plugin installation.",a.icon=getIDByName("ic_close_16px");break;case"installed_plugin":a.text="Plugin has been installed.",a.icon=getIDByName("Check");break;case"overridden_plugin":a.text="Plugin has been overriden.",a.icon=getIDByName("Check");break}Toasts.open({content:a.text,source:a.icon})})}}))}if(AddonChannels.Themes.includes(n.channel_id)){const s=n.content.match(/http(|s).+.json/gmi)?.[0];if(!s)return;r.unshift(React.createElement(FormRow,{label:"Install Theme",leading:React.createElement(Icon,{...o.icon,size:"medium",disableColor:!1,source:getIDByName("ic_download_24px")}),onPress:()=>{installTheme(s,({data:i,restart:a})=>{const l={icon:null,text:null,restart:!1};switch(i){case"fucky_wucky":l.text="Failed theme installation.",l.icon=getIDByName("ic_close_16px");break;case"installed_theme":l.text="Theme has been installed.",l.icon=getIDByName("Check"),l.restart=a;break;case"overridden_theme":l.text="Theme has been overriden.",l.icon=getIDByName("Check"),l.restart=a;break}if(Toasts.open({content:l.text,source:l.icon}),l.restart)return Dialog.show({title:"Theme Replaced",body:"Replacing the theme you previously had applied requires a restart, would you like to restart Discord to reload the theme values?",confirmText:"Yes",cancelText:"No",onConfirm:reloadDiscord})})}}))}})}const Settings=NavigationStack.createStackNavigator(),{ThemeColorMap:ThemeColorMap$6}=ColorMap;function PluginSettings({name:e="hi",children:t=React.createElement(Text,null,"hi")}={}){const n=StyleSheet$1.createThemedStyleSheet({container:{backgroundColor:ThemeColorMap$6.BACKGROUND_MOBILE_SECONDARY,flex:1},cardStyle:{backgroundColor:"transparent"},header:{backgroundColor:ThemeColorMap$6.BACKGROUND_MOBILE_SECONDARY,shadowColor:"transparent",elevation:0},headerTitleContainer:{color:ThemeColorMap$6.HEADER_PRIMARY},close:{color:ThemeColorMap$6.HEADER_PRIMARY}});return React.createElement(NavigationNative.NavigationContainer,null,React.createElement(Settings.Navigator,{initialRouteName:e,style:n.container},React.createElement(Settings.Screen,{name:e,component:t,options:{cardOverlayEnabled:!1,cardShadowEnabled:!1,cardStyle:n.cardStyle,headerStyle:n.header,headerTitleContainerStyle:n.headerTitleContainer,headerTitleAlign:"center",animationEnabled:!0,animationTypeForReplace:"pop",safeAreaInsets:{top:0},headerTitleStyle:{color:"white"},headerLeft:()=>React.createElement(Button,{color:n.close.color,title:"Close",onPress:()=>Navigation.pop()}),...NavigationStack.TransitionPresets.ModalSlideFromBottomIOS}})))}const{ThemeColorMap:ThemeColorMap$5}=ColorMap;function Authors({authors:e}){if(!e||!Array.isArray(e)||!e.length)return null;const t=StyleSheet$1.createThemedStyleSheet({linkless:{color:ThemeColorMap$5.HEADER_SECONDARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,display:"flex",alignItems:"center",alignSelf:"center",justifyContent:"center"},link:{color:ThemeColorMap$5.HEADER_PRIMARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,display:"flex",alignItems:"center",alignSelf:"center",justifyContent:"center"},container:{marginLeft:2.5}});return React.createElement(View,{style:t.container},e.map((n,r)=>{const o=r!==e.length-1;return typeof n=="string"?React.createElement(Text,{style:t.linkless},n,o&&","):typeof n=="object"&&n.name&&!n.id?React.createElement(Text,{style:t.linkless},n.name,o&&","):typeof n=="object"&&n.name&&n.id?React.createElement(TouchableOpacity,{key:n.id,onPress:()=>Profiles.showUserProfile({userId:n.id})},React.createElement(Text,{style:t.link},n.name,o&&",")):null}).filter(Boolean))}const{createThemedStyleSheet:createThemedStyleSheet$1}=StyleSheet$1,{ThemeColorMap:ThemeColorMap$4}=ColorMap;function PluginCard({plugin:e}){const t=getEnabledPlugins(),[n,r]=React.useState(t.includes(e.name)),o=StyleSheet$1.createThemedStyleSheet({container:{backgroundColor:ThemeColorMap$4.BACKGROUND_SECONDARY,borderRadius:5,borderLeftColor:e.color??"#524FBF",borderLeftWidth:5,marginBottom:15},name:{color:ThemeColorMap$4.HEADER_PRIMARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,fontSize:16},version:{color:ThemeColorMap$4.HEADER_SECONDARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,marginLeft:2.5},content:{height:"auto",paddingBottom:10,paddingLeft:10,paddingRight:10},actions:{justifyContent:"flex-end",flexDirection:"row",alignItems:"center"},description:{color:ThemeColorMap$4.HEADER_SECONDARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD},info:{marginLeft:-6,flexDirection:"row",alignItems:"center"},delete:{marginRight:7.5},trashIcon:{width:22,height:22,tintColor:"white"},settingsIcon:{width:22,height:22,tintColor:"white"}});return React.createElement(View,{style:o.container},React.createElement(View,null,React.createElement(FormRow,{label:()=>React.createElement(View,{style:o.info},React.createElement(Text,{style:o.name},e.name),e.version&&React.createElement(Text,{style:o.version},e.version," ",e.authors&&"by"),React.createElement(Authors,{authors:e.authors})),trailing:()=>React.createElement(View,{style:o.actions},React.createElement(TouchableOpacity,{style:o.delete,onPress:()=>{Navigation.push(PluginSettings)}},React.createElement(Image,{style:o.settingsIcon,source:Assets$1.getIDByName("settings")})),React.createElement(TouchableOpacity,{style:o.delete,onPress:()=>void uninstallPlugin(e.name)},React.createElement(Image,{style:o.trashIcon,source:Assets$1.getIDByName("ic_trash_filled_16px")})),React.createElement(FormSwitch,{value:n,onValueChange:s=>{r(s),Toasts.open({content:`${e.name} has been ${s?"enabled":"disabled"}.`}),s?enablePlugin(e.name):disablePlugin(e.name)}}))})),React.createElement(View,{style:o.content},React.createElement(Text,{style:o.description},e.description??"No description provided.")))}function HeaderRight$2(){const e=createThemedStyleSheet$1({header:{tintColor:ThemeColorMap$4.HEADER_PRIMARY,marginRight:15,width:18,height:18},wrapper:{marginRight:15,width:32,height:32}});return React.createElement(TouchableOpacity,{styles:e.wrapper,onPress:()=>{Alert.prompt("Install a plugin","Please enter the URL of the plugin to install.",t=>{if(!t.endsWith("js"))return Toasts.open({content:"Invalid URL for theme",source:Assets$1.getIDByName("ic_close_16px")});installPlugin(t,({data:n})=>{const r={icon:null,text:null};switch(n){case"fucky_wucky":r.text="Failed plugin installation.",r.icon=Assets$1.getIDByName("ic_close_16px");break;case"installed_plugin":r.text="Plugin has been installed.",r.icon=Assets$1.getIDByName("Check");break;case"overridden_plugin":r.text="Plugin has been overriden.",r.icon=Assets$1.getIDByName("Check");break}Toasts.open({content:r.text,source:r.icon})})})}},React.createElement(Image,{style:e.header,source:Assets$1.getIDByName("add_white")}))}const Search$1=getByProps("SearchBarNavWrapper",{default:!1});function Page$2(){const e=React.useState(null)[1],[t,n]=React.useState(getPlugins().sort((c,u)=>c.name.localeCompare(u.name))),[r,o]=React.useState(!1),[s,i]=React.useState(null);React.useEffect(()=>{function c(){e({})}return on$1("installed",c),on$1("uninstalled",c),()=>{off$1("installed",c),off$1("uninstalled",c)}},[]);const a=s?t.filter(c=>!!(c.name.toLowerCase().includes(s.toLowerCase())||c.description?.toLowerCase().includes(s.toLowerCase())||c.authors?.find?.(u=>(u.name??u).toLowerCase().includes(s.toLowerCase())))):t,l=createThemedStyleSheet$1({container:{flex:1,padding:5},notFound:{display:"flex",justifyContent:"center",alignItems:"center",alignSelf:"center",marginTop:"50%"},notFoundText:{marginTop:10,color:ThemeColorMap$4.TEXT_MUTED,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,textAlign:"center"},search:{marginTop:7.5,paddingRight:10,paddingLeft:10,backgroundColor:"none",borderBottomWidth:0}});return React.createElement(React.Fragment,null,React.createElement(Search$1.SearchBarNavWrapper,{style:l.search,placeholder:"Search plugins...",onChangeText:c=>i(c)}),React.createElement(View,{style:l.container},React.createElement(ScrollView,{style:l.container,refreshControl:React.createElement(RefreshControl,{refreshing:r,onRefresh:()=>{o(!0),n(getPlugins()),o(!1)}})},a.length?a.map(c=>React.createElement(PluginCard,{plugin:c})):s?React.createElement(View,{style:l.notFound},React.createElement(Image,{source:Assets$1.getIDByName("img_no_results_dark")}),React.createElement(Text,{style:l.notFoundText},"We searched far and wide."),React.createElement(Text,{style:{...l.notFoundText,marginTop:0}},"Unfortunately, no results were found.")):React.createElement(View,{style:l.notFound},React.createElement(Image,{source:Assets$1.getIDByName("img_connection_empty_dark")}),React.createElement(Text,{style:l.notFoundText},"You don't have any plugins."),React.createElement(Text,{style:{...l.notFoundText,marginTop:0}},"Install some by clicking the + icon!")))))}const{createThemedStyleSheet}=StyleSheet$1,{ThemeColorMap:ThemeColorMap$3}=ColorMap;function ThemeCard({theme:e}){const t=getTheme(),[n,r]=React.useState(t===e.name),o=StyleSheet$1.createThemedStyleSheet({container:{backgroundColor:ThemeColorMap$3.BACKGROUND_SECONDARY,borderRadius:5,borderLeftColor:e.color??"#524FBF",borderLeftWidth:5,marginBottom:15},name:{color:ThemeColorMap$3.HEADER_PRIMARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,fontSize:16},version:{color:ThemeColorMap$3.HEADER_SECONDARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,marginLeft:2.5},content:{height:"auto",paddingBottom:10,paddingLeft:10,paddingRight:10},actions:{justifyContent:"flex-end",flexDirection:"row",alignItems:"center"},description:{color:ThemeColorMap$3.HEADER_SECONDARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD},info:{marginLeft:-6,flexDirection:"row",alignItems:"center"},delete:{marginRight:7.5},trashIcon:{width:22,height:22}});return React.createElement(View,{style:o.container},React.createElement(View,null,React.createElement(FormRow,{label:()=>React.createElement(View,{style:o.info},React.createElement(Text,{style:o.name},e.name),e.version&&React.createElement(Text,{style:o.version},e.version," ",e.authors&&"by"),React.createElement(Authors,{authors:e.authors})),trailing:()=>React.createElement(View,{style:o.actions},React.createElement(TouchableOpacity,{style:o.delete,onPress:()=>{uninstallTheme(e.name,()=>{n&&Dialog.show({title:"Theme Uninstalled",body:"Uninstalling the theme you previously had applied requires a restart, would you like to restart Discord to remove the theme?",confirmText:"Yes",cancelText:"No",onConfirm:reloadDiscord})})}},React.createElement(Image,{style:o.trashIcon,source:Assets$1.getIDByName("ic_trash_filled_16px")})),React.createElement(FormSwitch,{value:n,onValueChange:s=>{r(s),Toasts.open({content:`${e.name} has been ${s?"enabled":"disabled"}.`}),s?(applyTheme(e.name),Dialog.show({title:"Theme Applied",body:"Applying a theme requires a restart, would you like to restart Discord to apply the theme?",confirmText:"Yes",cancelText:"No",onConfirm:reloadDiscord})):(removeTheme(),Dialog.show({title:"Theme Removed",body:"Removing the applied theme requires a restart, would you like to restart Discord to remove the applied theme?",confirmText:"Yes",cancelText:"No",onConfirm:reloadDiscord}))}}))})),React.createElement(View,{style:o.content},React.createElement(Text,{style:o.description},e.description??"No description provided.")))}function HeaderRight$1(){const e=createThemedStyleSheet({header:{tintColor:ThemeColorMap$3.HEADER_PRIMARY,marginRight:15,width:18,height:18},wrapper:{marginRight:15,width:32,height:32}});return React.createElement(TouchableOpacity,{styles:e.wrapper,onPress:()=>{Alert.prompt("Install a theme","Please enter the URL of a theme to install.",t=>{if(!t.endsWith("json"))return Toasts.open({content:"Invalid URL for theme",source:Assets$1.getIDByName("ic_close_16px")});try{installTheme(t,({data:n,restart:r})=>{const o={icon:null,text:null,restart:!1};switch(n){case"fucky_wucky":o.text="Failed theme installation.",o.icon=Assets$1.getIDByName("ic_close_16px");break;case"installed_theme":o.text="Theme has been installed.",o.icon=Assets$1.getIDByName("Check"),o.restart=r;break;case"overridden_theme":o.text="Theme has been overriden.",o.icon=Assets$1.getIDByName("Check"),o.restart=r;break}if(Toasts.open({content:o.text,source:o.icon}),o.restart)return Dialog.show({title:"Theme Replaced",body:"Replacing the theme you previously had applied requires a restart, would you like to restart Discord to reload the theme values?",confirmText:"Yes",cancelText:"No",onConfirm:reloadDiscord})})}catch(n){Toasts.open({content:n.message})}})}},React.createElement(Image,{style:e.header,source:Assets$1.getIDByName("add_white")}))}const Search=getByProps("SearchBarNavWrapper",{default:!1});function Page$1(){const e=React.useState(null)[1],[t,n]=React.useState(listThemes().sort((c,u)=>c.name.localeCompare(u.name))),[r,o]=React.useState(!1),[s,i]=React.useState(null);React.useEffect(()=>{function c(){e({})}return on("installed",c),on("uninstalled",c),()=>{off("installed",c),off("uninstalled",c)}},[]);const a=s?t.filter(c=>!!(c.name.toLowerCase().includes(s.toLowerCase())||c.description?.toLowerCase().includes(s.toLowerCase())||c.authors?.find?.(u=>(u.name??u).toLowerCase().includes(s.toLowerCase())))):t,l=createThemedStyleSheet({container:{flex:1,padding:5},notFound:{display:"flex",justifyContent:"center",alignItems:"center",alignSelf:"center",marginTop:"50%"},notFoundText:{marginTop:10,color:ThemeColorMap$3.TEXT_MUTED,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,textAlign:"center"},search:{marginTop:7.5,paddingRight:10,paddingLeft:10,backgroundColor:"none",borderBottomWidth:0}});return React.createElement(React.Fragment,null,React.createElement(Search.SearchBarNavWrapper,{style:l.search,placeholder:"Search themes...",onChangeText:c=>i(c)}),React.createElement(View,{style:l.container},React.createElement(ScrollView,{style:l.container,refreshControl:React.createElement(RefreshControl,{refreshing:r,onRefresh:()=>{o(!0),n(listThemes()),o(!1)}})},a.length?a.map(c=>React.createElement(ThemeCard,{theme:c})):s?React.createElement(View,{style:l.notFound},React.createElement(Image,{source:Assets$1.getIDByName("img_no_results_dark")}),React.createElement(Text,{style:l.notFoundText},"We searched far and wide."),React.createElement(Text,{style:{...l.notFoundText,marginTop:0}},"Unfortunately, no results were found.")):React.createElement(View,{style:l.notFound},React.createElement(Image,{source:Assets$1.getIDByName("img_connection_empty_dark")}),React.createElement(Text,{style:l.notFoundText},"You don't have any themes."),React.createElement(Text,{style:{...l.notFoundText,marginTop:0}},"Install some by clicking the + icon!")))))}const{ThemeColorMap:ThemeColorMap$2}=ColorMap;function ThemeIcon({height:e,width:t,...n}){const r=StyleSheet$1.createThemedStyleSheet({icon:{color:ThemeColorMap$2.INTERACTIVE_NORMAL,opacity:.75,marginLeft:.5}});return React.createElement(SVG.Svg,{viewBox:"0 0 24 24",style:{height:e,width:t,...r.icon},fill:"currentColor",...n},React.createElement(SVG.Path,{d:"M0 0h24v24H0z",fill:"none"}),React.createElement(SVG.Path,{d:"M20.5 11H19V7c0-1.1-.9-2-2-2h-4V3.5C13 2.12 11.88 1 10.5 1S8 2.12 8 3.5V5H4c-1.1 0-1.99.9-1.99 2v3.8H3.5c1.49 0 2.7 1.21 2.7 2.7s-1.21 2.7-2.7 2.7H2V20c0 1.1.9 2 2 2h3.8v-1.5c0-1.49 1.21-2.7 2.7-2.7 1.49 0 2.7 1.21 2.7 2.7V22H17c1.1 0 2-.9 2-2v-4h1.5c1.38 0 2.5-1.12 2.5-2.5S21.88 11 20.5 11z"}))}const{ThemeColorMap:ThemeColorMap$1}=ColorMap;function PluginIcon({height:e,width:t,...n}){const r=StyleSheet$1.createThemedStyleSheet({icon:{color:ThemeColorMap$1.INTERACTIVE_NORMAL,opacity:.75,marginLeft:.5}});return React.createElement(SVG.Svg,{viewBox:"0 0 24 24",style:{height:e,width:t,...r.icon},fill:"currentColor",...n},React.createElement(SVG.Path,{d:"M0 0h24v24H0z",fill:"none"}),React.createElement(SVG.Path,{d:"M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"}))}const ThemeColorMap=ColorMap.ThemeColorMap;function HeaderRight(){return null}function Page({settings:e}){const t=StyleSheet$1.createThemedStyleSheet({debugText:{color:ThemeColorMap.TEXT_MUTED}}),n={Twitter:getIDByName("img_account_sync_twitter_white"),GitHub:getIDByName("img_account_sync_github_white"),Addon:getIDByName("img_nitro_increase_guild_limit"),Checkmark:getIDByName("Check"),Discord:getIDByName("Discord")},r=[...window.plugins.enabled,...window.plugins.disabled],o=listThemes();return React.createElement(ScrollView,null,React.createElement(KeyboardAvoidingView,{enabled:!0,behavior:"position",style:t.container,keyboardVerticalOffset:100,contentContainerStyle:{backfaceVisibility:"hidden"}},React.createElement(FormSection,{title:"Links"},React.createElement(FormRow,{label:"GitHub",leading:React.createElement(FormRow.Icon,{source:n.GitHub}),trailing:FormRow.Arrow,onPress:()=>Linking.openURL("https://github.com/enmity-mod")}),React.createElement(FormRow,{label:"Twitter",leading:React.createElement(FormRow.Icon,{source:n.Twitter}),trailing:FormRow.Arrow,onPress:()=>Linking.openURL("https://twitter.com/EnmityApp")})),React.createElement(FormSection,{title:"Debug"},React.createElement(FormRow,{label:"Discord Version",leading:React.createElement(FormRow.Icon,{source:n.Discord}),trailing:()=>React.createElement(Text,{style:t.debugText},getVersion()),onPress:()=>{Toasts.open({content:"Copied to clipboard",source:n.Checkmark}),Clipboard.setString(getVersion())}}),React.createElement(FormRow,{label:"Enmity Version",leading:React.createElement(FormRow.Icon,{source:{uri:"https://files.enmity.app/icon-64.png"}}),trailing:()=>React.createElement(Text,{style:t.debugText},window.enmity.version),onPress:()=>Linking.openURL(`https://github.com/enmity-mod/enmity/commit/${window.enmity.version}`)}),React.createElement(FormRow,{label:"Installed Plugins",leading:React.createElement(ThemeIcon,{width:24,height:24}),trailing:()=>React.createElement(Text,{style:t.debugText},r.length),onPress:()=>{Toasts.open({content:"Copied to clipboard",source:n.Checkmark}),Clipboard.setString(`**Plugins**: ${r.join(", ")}`)}}),React.createElement(FormRow,{label:"Installed Themes",leading:React.createElement(PluginIcon,{width:24,height:24}),trailing:()=>React.createElement(Text,{style:t.debugText},o.length),onPress:()=>{Toasts.open({content:"Copied to clipboard",source:n.Checkmark}),Clipboard.setString(`**Themes**: ${o.join(", ")}`)}}),React.createElement(FormRow,{label:"Automatically connect to debug websocket",trailing:React.createElement(FormSwitch,{value:e.getBoolean("autoConnectWS",!1),onValueChange:()=>e.toggle("autoConnectWS",!1)})}),e.getBoolean("autoConnectWS",!1)&&React.createElement(FormInput,{value:e.get("debugWSAddress","192.168.0.1:9090"),onChange:s=>e.set("debugWSAddress",s),title:"DEBUG IP"}))))}const Patcher$1=create$1("enmity-settings");function patchSettings(){patchScreens(),patchSettings$1()}function patchScreens(){Patcher$1.after(Scenes,"default",(e,t,n)=>({...n,Enmity:{key:"Enmity",title:"Enmity",render:connectComponent(Page,"enmity"),headerRight:HeaderRight},EnmityPlugins:{key:"Enmity Plugins",title:"Plugins",render:Page$2,headerRight:HeaderRight$2},EnmityThemes:{key:"Enmity Themes",title:"Themes",render:Page$1,headerRight:HeaderRight$1}}))}const patch={status:!1,forceUpdate:()=>{},navigator:null,handleSectionSelect:()=>{}};function patchSettings$1(){const e=getByTypeName("UserSettingsOverviewWrapper",{default:!1});Patcher$1.after(e,"default",(t,n,r)=>{const o=React.useState({})[1];patch.forceUpdate=()=>o({});const{navigation:s}=r.props;patch.navigator=s,!patch.status&&(Patcher$1.after(r.type.prototype,"render",(i,a,l)=>{const{children:c}=l.props,u=c.findIndex(d=>d.props.title===Locale.Messages.PREMIUM_SETTINGS);patch.handleSectionSelect=(...d)=>r.type.prototype.handleSectionSelect.apply(i,d),c.splice(u,0,React.createElement(React.Fragment,null,React.createElement(FormSection,{key:"Enmity",title:"Enmity"},React.createElement(FormRow,{label:"General",trailing:React.createElement(FormArrow,null),onPress:()=>void s.push("Enmity")}),React.createElement(FormDivider,null),React.createElement(FormRow,{label:"Plugins",trailing:React.createElement(FormArrow,null),onPress:()=>void s.push("EnmityPlugins")}),React.createElement(FormDivider,null),React.createElement(FormRow,{label:"Themes",trailing:React.createElement(FormArrow,null),onPress:()=>void s.push("EnmityThemes")}),React.createElement(FormDivider,null))))}),patch.status=!0)})}const Patcher=create$1("no-track"),blacklist=["useTrackExpressionPickerInlineStickersUpsell","useTrackThreadArchivalDurationUpsell","useAndTrackNonFriendDMAccept","StreamRTCAnalyticsContext","useAndTrackDMSpamAccept","useAnalyticsContext","trackExposure","SpotifyTrack","useAndTrack","TextTrack"],Trackers=getModules(e=>typeof e=="object"&&[...Object.keys(e),...Object.keys(e.__proto__),...Object.keys(e.prototype??{})].some(t=>~t.toLowerCase().indexOf("track")||~t.toLowerCase().indexOf("analytics"))),Reporters=getModules(e=>typeof e=="object"&&[...Object.keys(e),...Object.keys(e.__proto__),...Object.keys(e.prototype??{})].some(t=>~t.toLowerCase().indexOf("crashreport")));function patchTracking(){for(let t=0;t<Trackers.length;t++){const n=o=>(~o.toLowerCase().indexOf("track")||~o.toLowerCase().indexOf("analytics"))&&!blacklist.some(s=>o===s),r=Trackers[t];traverse(r,n),traverse(r.default,n)}for(let t=0;t<Reporters.length;t++){const n=o=>~o.toLowerCase().indexOf("crashreport")&&!blacklist.some(s=>o===s),r=Reporters[t];traverse(r,n),traverse(r.default,n)}const e={main:window.__SENTRY__?.hub,client:window.__SENTRY__?.hub?.getClient()};if(e.main&&e.client){e.client.close(0),e.main.getStackTop().scope.clear(),e.main.getScope().clear(),Patcher.instead(e.main,"addBreadcrumb",()=>{}),window.__oldConsole=window.console;for(const t of["debug","info","warn","error","log","assert"]){const n=console[t];if(!!n){if(n.__sentry_original__)console[t]=n.__sentry_original__;else if(n.__REACT_DEVTOOLS_ORIGINAL_METHOD__){const r=n.__REACT_DEVTOOLS_ORIGINAL_METHOD__.__sentry_original__;console[t].__REACT_DEVTOOLS_ORIGINAL_METHOD__=r}}}}}function traverse(e,t){if(!e||!t)return;const n=[...Object.keys(e),...Object.keys(e.__proto__),...Object.keys(e.prototype??{})].filter(t);for(let r=0;r<n.length;r++){const o=n[r],s=typeof(e[o]??e.__proto__[o]??e.prototype?.[o]);!~["function","object"].indexOf(s)||blacklist.some(i=>o===i)||(typeof e[o]=="object"?traverse(e[o],t):e.prototype?.[o]&&isConfigurable(e.prototype,o)?Patcher.instead(e.prototype,o,()=>Promise.resolve()):e.__proto__[o]&&isConfigurable(e.__proto__,o)?Patcher.instead(e.__proto__,o,()=>Promise.resolve()):e[o]&&isConfigurable(e,o)&&Patcher.instead(e,o,()=>Promise.resolve()))}}function isConfigurable(e,t){return!!Object.getOwnPropertyDescriptor(e,t).configurable}function initialize$3(){try{patchSettings()}catch(e){console.log("Failed to patch settings: ",e.message)}try{patchTracking()}catch(e){console.log("Failed to patch trackers: ",e.message)}try{patchDownloader()}catch(e){console.log("Failed to patch addon downloader: ",e.message)}}var CorePatches={initialize:initialize$3};Avatars.BOT_AVATARS.ENMITY="https://github.com/enmity-mod.png";function sendReply(e,t,n,r){const o=Clyde$1.createBotMessage(e,"");o.author.username=n??"Enmity",o.author.avatar=r?n:"ENMITY",r&&(Avatars.BOT_AVATARS[n]=r),typeof t=="string"?o.content=t:Object.assign(o,t),Messages.receiveMessage(e,o)}var Clyde=Object.freeze({__proto__:null,sendReply}),ApplicationCommandSectionType;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.Guild=1]="Guild",e[e.DM=2]="DM"})(ApplicationCommandSectionType||(ApplicationCommandSectionType={}));var ApplicationCommandType;(function(e){e[e.Chat=1]="Chat",e[e.User=2]="User",e[e.Message=3]="Message"})(ApplicationCommandType||(ApplicationCommandType={}));var ApplicationCommandInputType;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.BuiltInText=1]="BuiltInText",e[e.BuiltInIntegration=2]="BuiltInIntegration",e[e.Bot=3]="Bot",e[e.Placeholder=4]="Placeholder"})(ApplicationCommandInputType||(ApplicationCommandInputType={}));var ApplicationCommandPermissionType;(function(e){e[e.Role=1]="Role",e[e.User=2]="User"})(ApplicationCommandPermissionType||(ApplicationCommandPermissionType={}));var ApplicationCommandOptionType;(function(e){e[e.SubCommand=1]="SubCommand",e[e.SubCommandGroup=2]="SubCommandGroup",e[e.String=3]="String",e[e.Integer=4]="Integer",e[e.Boolean=5]="Boolean",e[e.User=6]="User",e[e.Channel=7]="Channel",e[e.Role=8]="Role",e[e.Mentionnable=9]="Mentionnable",e[e.Number=10]="Number"})(ApplicationCommandOptionType||(ApplicationCommandOptionType={}));var InteractionTypes;(function(e){e[e.ApplicationCommand=2]="ApplicationCommand",e[e.MessageComponent=3]="MessageComponent"})(InteractionTypes||(InteractionTypes={}));const list={id:"installed-plugins",applicationId:section.id,name:"plugins",displayName:"plugins",description:"List installed plugins",displayDescription:"List installed plugins",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,execute:(e,t)=>{const n=t.channel.id;if(getPlugins().length===0){sendReply(n,"No plugins installed.");return}const o=getEnabledPlugins(),s=getDisabledPlugins();let i="";o.length>0&&(i=`**Enabled plugins (${o.length})**:
`,i+=`> ${o.join(", ")}
`),s.length>0&&(i+=`**Disabled plugins (${s.length})**:
`,i+=`> ${s.join(", ")}`),sendReply(n,i)}},install={id:"install-plugin",applicationId:section.id,name:"install",displayName:"install",description:"Install a plugin",displayDescription:"Install a plugin",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,options:[{name:"plugin",displayName:"plugin",description:"Plugin url",displayDescription:"Plugin url",required:!0,type:ApplicationCommandOptionType.String}],execute:(e,t)=>{const n=e[0].value,r=t.channel.id;installPlugin(n,o=>{sendReply(r,o)})}},uninstall={id:"uninstall-plugin",applicationId:section.id,name:"uninstall",displayName:"uninstall",description:"Uninstall a plugin",displayDescription:"Uninstall a plugin",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,options:[{name:"plugin",displayName:"plugin",description:"Plugin name",displayDescription:"Plugin name",type:ApplicationCommandOptionType.String,required:!0}],execute:(e,t)=>{const n=e[0].value,r=t.channel.id;uninstallPlugin(n,o=>{sendReply(r,o)})}},disable={id:"disable-plugin",applicationId:section.id,name:"disable",displayName:"disable",description:"Disable a plugin",displayDescription:"Disable a plugin",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,options:[{name:"plugin",displayName:"plugin",description:"Plugin name",displayDescription:"Plugin name",type:ApplicationCommandOptionType.String,required:!0}],execute:(e,t)=>{const n=e[0].value,r=t.channel.id;disablePlugin(n,o=>{if(o==="yes"){sendReply(r,`**${n}** has been disabled.`);return}sendReply(r,`Error when disabling **${n}**.`)})}},enable={id:"enable-plugin",applicationId:section.id,name:"enable",displayName:"enable",description:"Enable a plugin",displayDescription:"Enable a plugin",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,options:[{name:"plugin",displayName:"plugin",description:"Plugin name",displayDescription:"Plugin name",type:ApplicationCommandOptionType.String,required:!0}],execute:(e,t)=>{const n=e[0].value,r=t.channel.id;enablePlugin(n,o=>{if(o==="yes"){sendReply(r,`**${n}** has been enabled.`);return}sendReply(r,`Error when enabling **${n}**.`)})}};var plugins=[list,install,uninstall,disable,enable];const themes={id:"list-themes",applicationId:section.id,name:"themes",displayName:"themes",description:"List available themes",displayDescription:"List available themes",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,execute:(e,t)=>{const n=listThemes();if(n.length===0){sendReply(t.channel.id,"No themes installed.");return}sendReply(t.channel.id,`**Installed themes (${n.length})**: ${n.join(", ")}`)}},apply={id:"apply-theme",applicationId:section.id,name:"apply",displayName:"apply",description:"Apply a theme",displayDescription:"Apply a theme",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,options:[{name:"name",displayName:"name",description:"Theme's name",displayDescription:"Theme's name",type:ApplicationCommandOptionType.String,required:!0,choices:listThemes().map(e=>({name:e.name,displayName:e.name,value:e.name}))}],execute:(e,t)=>{const n=e[0].value;getThemeByName(n)||sendReply(t.channel.id,"Theme couldn't be found."),applyTheme(n).then(o=>{sendReply(t.channel.id,o)})}},clear={id:"clear-theme",applicationId:section.id,name:"clear",displayName:"clear",description:"Remove applied theme",displayDescription:"Remove applied theme",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,execute:(e,t)=>{removeTheme().then(n=>{sendReply(t.channel.id,n)})}};var themes$1=[themes,apply,clear];const debug={id:"debug-command",name:"debug",displayName:"debug",description:"Print out your device information",displayDescription:"Print out your device information",applicationId:section.id,type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltInText,execute:()=>{let e=`**Debug Info:**
`;return e+=`> Enmity: ${window.enmity.version}
`,e+=`> Discord: ${getVersion()} (${getBuild()})
`,e+=`> Device: ${getDevice()}
`,e+=`> System: ${getSystemVersion()}
`,{content:e}}},reload={id:"reload-command",name:"reload",displayName:"reload",description:"Reload Discord",displayDescription:"Reload Discord",applicationId:section.id,type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,execute:function(e){reloadDiscord()}},getToken={id:"token-command",name:"token",displayName:"token",description:"Show your Discord's token",displayDescription:"Show your Discord's token",applicationId:section.id,type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,execute:function(e,t){sendReply(t.channel.id,Token.getToken())}};var utils=[debug,reload,getToken];const connect={id:"websocket-devtools",applicationId:section.id,name:"websocket",displayName:"websocket",description:"Connect to the websocket server",displayDescription:"Connect to the websocket server",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,options:[{name:"host",displayName:"host",description:"Host of the debugger",displayDescription:"Host of the debugger",type:ApplicationCommandOptionType.String,required:!0}],execute:e=>{const t=e[0].value;connectWebsocket(t)}},dump={id:"dump-command",applicationId:section.id,name:"dump",displayName:"dump",description:"Dump Discord's modules",displayDescription:"Dump Discord's modules",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,execute:function(e,t){const n=t.channel.id,r=window.modules;function o(s){if(typeof s=="function")return s.toString();if(Array.isArray(s))return s.map(o);if(typeof s=="object"){const i={};for(const a in s)i[a]=o(s[a]);return i}return s}for(const s of Object.keys(r))try{const i=r[s],a={id:s};if(!i.publicModule?.exports)continue;const l=i.publicModule.exports;for(const c of Object.keys(i.publicModule.exports))a[c]=o(l[c]);sendMessage(JSON.stringify(a,null,"	"))}catch(i){console.log(`Couldn't dump module ${s}`),console.log(i)}sendReply(n,"Modules has been dumped.")}};var websocket=[connect,dump];function initialize$2(){const e=[...plugins,...websocket,...utils,...themes$1];registerCommands("enmity",e)}var Commands={initialize:initialize$2};const API={modules:Modules,themer:Themes,patcher:Patcher$4,version:"61a8161",plugins:Plugins,clyde:Clyde,commands:Commands$2,settings:Settings$2,components:Components,native:Native,assets:Assets$2,clipboard:Clipboard,storage:Storage,token:Token,users:Users,rest:REST,react:{...React,...Components,React},dialog:{showDialog:Dialog.show},toasts:{showToast:Toasts.open}};function initialize$1(){window.enmity=API}var API$1={API,initialize:initialize$1};function initialize(){WebSocket$1.initialize(),API$1.initialize(),CorePatches.initialize(),Commands.initialize()}var Enmity={initialize};try{Enmity.initialize()}catch(e){alert(`Enmity failed to initialize: ${e.message}`),console.error(e)}
